(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const h of l.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&o(h)}).observe(document,{childList:!0,subtree:!0});function t(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(s){if(s.ep)return;s.ep=!0;const l=t(s);fetch(s.href,l)}})();const $r=(r,e)=>r===e,mn=Symbol("solid-proxy"),Kt={equals:$r};let qr=gr;const et=1,Ot=2,ir={owned:null,cleanups:null,context:null,owner:null};var fe=null;let gn=null,Yr=null,xe=null,Ae=null,Qe=null,Gt=0;function or(r,e){const t=xe,o=fe,s=r.length===0,l=e===void 0?o:e,h=s?ir:{owned:null,cleanups:null,context:l?l.context:null,owner:l},d=s?r:()=>r(()=>qe(()=>Jt(h)));fe=h,xe=null;try{return Je(d,!0)}finally{xe=t,fe=o}}function ot(r,e){e=e?Object.assign({},Kt,e):Kt;const t={value:r,observers:null,observerSlots:null,comparator:e.equals||void 0},o=s=>(typeof s=="function"&&(s=s(t.value)),ur(t,s));return[lr.bind(t),o]}function mt(r,e,t){const o=dr(r,e,!1,et);Ht(o)}function Ce(r,e,t){t=t?Object.assign({},Kt,t):Kt;const o=dr(r,e,!0,0);return o.observers=null,o.observerSlots=null,o.comparator=t.equals||void 0,Ht(o),lr.bind(o)}function Gr(r){return Je(r,!1)}function qe(r){if(xe===null)return r();const e=xe;xe=null;try{return r()}finally{xe=e}}function Rn(r,e,t){const o=Array.isArray(r);let s,l=t&&t.defer;return h=>{let d;if(o){d=Array(r.length);for(let m=0;m<r.length;m++)d[m]=r[m]()}else d=r();if(l)return l=!1,h;const S=qe(()=>e(d,s,h));return s=d,S}}function sr(r){return fe===null||(fe.cleanups===null?fe.cleanups=[r]:fe.cleanups.push(r)),r}function ar(){return fe}function fr(r,e){const t=fe,o=xe;fe=r,xe=null;try{return Je(e,!0)}catch(s){Pn(s)}finally{fe=t,xe=o}}function Hr(r){const e=xe,t=fe;return Promise.resolve().then(()=>{xe=e,fe=t;let o;return Je(r,!1),xe=fe=null,o?o.done:void 0})}function cr(r,e){const t=Symbol("context");return{id:t,Provider:Vr(t),defaultValue:r}}function Jr(r){return fe&&fe.context&&fe.context[r.id]!==void 0?fe.context[r.id]:r.defaultValue}function Un(r){const e=Ce(r),t=Ce(()=>_n(e()));return t.toArray=()=>{const o=t();return Array.isArray(o)?o:o!=null?[o]:[]},t}function lr(){if(this.sources&&this.state)if(this.state===et)Ht(this);else{const r=Ae;Ae=null,Je(()=>Ft(this),!1),Ae=r}if(xe){const r=this.observers?this.observers.length:0;xe.sources?(xe.sources.push(this),xe.sourceSlots.push(r)):(xe.sources=[this],xe.sourceSlots=[r]),this.observers?(this.observers.push(xe),this.observerSlots.push(xe.sources.length-1)):(this.observers=[xe],this.observerSlots=[xe.sources.length-1])}return this.value}function ur(r,e,t){let o=r.value;return(!r.comparator||!r.comparator(o,e))&&(r.value=e,r.observers&&r.observers.length&&Je(()=>{for(let s=0;s<r.observers.length;s+=1){const l=r.observers[s],h=gn&&gn.running;h&&gn.disposed.has(l),(h?!l.tState:!l.state)&&(l.pure?Ae.push(l):Qe.push(l),l.observers&&xr(l)),h||(l.state=et)}if(Ae.length>1e6)throw Ae=[],new Error},!1)),e}function Ht(r){if(!r.fn)return;Jt(r);const e=Gt;zr(r,r.value,e)}function zr(r,e,t){let o;const s=fe,l=xe;xe=fe=r;try{o=r.fn(e)}catch(h){return r.pure&&(r.state=et,r.owned&&r.owned.forEach(Jt),r.owned=null),r.updatedAt=t+1,Pn(h)}finally{xe=l,fe=s}(!r.updatedAt||r.updatedAt<=t)&&(r.updatedAt!=null&&"observers"in r?ur(r,o):r.value=o,r.updatedAt=t)}function dr(r,e,t,o=et,s){const l={fn:r,state:o,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:fe,context:fe?fe.context:null,pure:t};return fe===null||fe!==ir&&(fe.owned?fe.owned.push(l):fe.owned=[l]),l}function hr(r){if(r.state===0)return;if(r.state===Ot)return Ft(r);if(r.suspense&&qe(r.suspense.inFallback))return r.suspense.effects.push(r);const e=[r];for(;(r=r.owner)&&(!r.updatedAt||r.updatedAt<Gt);)r.state&&e.push(r);for(let t=e.length-1;t>=0;t--)if(r=e[t],r.state===et)Ht(r);else if(r.state===Ot){const o=Ae;Ae=null,Je(()=>Ft(r,e[0]),!1),Ae=o}}function Je(r,e){if(Ae)return r();let t=!1;e||(Ae=[]),Qe?t=!0:Qe=[],Gt++;try{const o=r();return Xr(t),o}catch(o){t||(Qe=null),Ae=null,Pn(o)}}function Xr(r){if(Ae&&(gr(Ae),Ae=null),r)return;const e=Qe;Qe=null,e.length&&Je(()=>qr(e),!1)}function gr(r){for(let e=0;e<r.length;e++)hr(r[e])}function Ft(r,e){r.state=0;for(let t=0;t<r.sources.length;t+=1){const o=r.sources[t];if(o.sources){const s=o.state;s===et?o!==e&&(!o.updatedAt||o.updatedAt<Gt)&&hr(o):s===Ot&&Ft(o,e)}}}function xr(r){for(let e=0;e<r.observers.length;e+=1){const t=r.observers[e];t.state||(t.state=Ot,t.pure?Ae.push(t):Qe.push(t),t.observers&&xr(t))}}function Jt(r){let e;if(r.sources)for(;r.sources.length;){const t=r.sources.pop(),o=r.sourceSlots.pop(),s=t.observers;if(s&&s.length){const l=s.pop(),h=t.observerSlots.pop();o<s.length&&(l.sourceSlots[h]=o,s[o]=l,t.observerSlots[o]=h)}}if(r.owned){for(e=r.owned.length-1;e>=0;e--)Jt(r.owned[e]);r.owned=null}if(r.cleanups){for(e=r.cleanups.length-1;e>=0;e--)r.cleanups[e]();r.cleanups=null}r.state=0}function Zr(r){return r instanceof Error?r:new Error(typeof r=="string"?r:"Unknown error",{cause:r})}function Pn(r,e=fe){throw Zr(r)}function _n(r){if(typeof r=="function"&&!r.length)return _n(r());if(Array.isArray(r)){const e=[];for(let t=0;t<r.length;t++){const o=_n(r[t]);Array.isArray(o)?e.push.apply(e,o):e.push(o)}return e}return r}function Vr(r,e){return function(o){let s;return mt(()=>s=qe(()=>(fe.context={...fe.context,[r]:o.value},Un(()=>o.children))),void 0),s}}let Qr=!1;function Me(r,e){return qe(()=>r(e||{}))}function Wt(){return!0}const ei={get(r,e,t){return e===mn?t:r.get(e)},has(r,e){return e===mn?!0:r.has(e)},set:Wt,deleteProperty:Wt,getOwnPropertyDescriptor(r,e){return{configurable:!0,enumerable:!0,get(){return r.get(e)},set:Wt,deleteProperty:Wt}},ownKeys(r){return r.keys()}};function xn(r){return(r=typeof r=="function"?r():r)?r:{}}function ti(){for(let r=0,e=this.length;r<e;++r){const t=this[r]();if(t!==void 0)return t}}function ni(...r){let e=!1;for(let h=0;h<r.length;h++){const d=r[h];e=e||!!d&&mn in d,r[h]=typeof d=="function"?(e=!0,Ce(d)):d}if(e)return new Proxy({get(h){for(let d=r.length-1;d>=0;d--){const S=xn(r[d])[h];if(S!==void 0)return S}},has(h){for(let d=r.length-1;d>=0;d--)if(h in xn(r[d]))return!0;return!1},keys(){const h=[];for(let d=0;d<r.length;d++)h.push(...Object.keys(xn(r[d])));return[...new Set(h)]}},ei);const t={},o=Object.create(null);for(let h=r.length-1;h>=0;h--){const d=r[h];if(!d)continue;const S=Object.getOwnPropertyNames(d);for(let m=S.length-1;m>=0;m--){const A=S[m];if(A==="__proto__"||A==="constructor")continue;const B=Object.getOwnPropertyDescriptor(d,A);if(!o[A])o[A]=B.get?{enumerable:!0,configurable:!0,get:ti.bind(t[A]=[B.get.bind(d)])}:B.value!==void 0?B:void 0;else{const H=t[A];H&&(B.get?H.push(B.get.bind(d)):B.value!==void 0&&H.push(()=>B.value))}}}const s={},l=Object.keys(o);for(let h=l.length-1;h>=0;h--){const d=l[h],S=o[d];S&&S.get?Object.defineProperty(s,d,S):s[d]=S?S.value:void 0}return s}const ri=r=>`Stale read from <${r}>.`;function vr(r){const e=r.keyed,t=Ce(()=>r.when,void 0,{equals:(o,s)=>e?o===s:!o==!s});return Ce(()=>{const o=t();if(o){const s=r.children;return typeof s=="function"&&s.length>0?qe(()=>s(e?o:()=>{if(!qe(t))throw ri("Show");return r.when})):s}return r.fallback},void 0,void 0)}function ii(r,e,t){let o=t.length,s=e.length,l=o,h=0,d=0,S=e[s-1].nextSibling,m=null;for(;h<s||d<l;){if(e[h]===t[d]){h++,d++;continue}for(;e[s-1]===t[l-1];)s--,l--;if(s===h){const A=l<o?d?t[d-1].nextSibling:t[l-d]:S;for(;d<l;)r.insertBefore(t[d++],A)}else if(l===d)for(;h<s;)(!m||!m.has(e[h]))&&e[h].remove(),h++;else if(e[h]===t[l-1]&&t[d]===e[s-1]){const A=e[--s].nextSibling;r.insertBefore(t[d++],e[h++].nextSibling),r.insertBefore(t[--l],A),e[s]=t[l]}else{if(!m){m=new Map;let B=d;for(;B<l;)m.set(t[B],B++)}const A=m.get(e[h]);if(A!=null)if(d<A&&A<l){let B=h,H=1,te;for(;++B<s&&B<l&&!((te=m.get(e[B]))==null||te!==A+H);)H++;if(H>A-d){const le=e[h];for(;d<A;)r.insertBefore(t[d++],le)}else r.replaceChild(t[d++],e[h++])}else h++;else e[h++].remove()}}}const Hn="_$DX_DELEGATE";function oi(r,e,t,o={}){let s;return or(l=>{s=l,e===document?r():br(e,r(),e.firstChild?null:void 0,t)},o.owner),()=>{s(),e.textContent=""}}function pr(r,e,t){let o;const s=()=>{const h=document.createElement("template");return h.innerHTML=r,h.content.firstChild},l=()=>(o||(o=s())).cloneNode(!0);return l.cloneNode=l,l}function yr(r,e=window.document){const t=e[Hn]||(e[Hn]=new Set);for(let o=0,s=r.length;o<s;o++){const l=r[o];t.has(l)||(t.add(l),e.addEventListener(l,si))}}function br(r,e,t,o){if(t!==void 0&&!o&&(o=[]),typeof e!="function")return Dt(r,e,o,t);mt(s=>Dt(r,e(),s,t),o)}function si(r){const e=`$$${r.type}`;let t=r.composedPath&&r.composedPath()[0]||r.target;for(r.target!==t&&Object.defineProperty(r,"target",{configurable:!0,value:t}),Object.defineProperty(r,"currentTarget",{configurable:!0,get(){return t||document}});t;){const o=t[e];if(o&&!t.disabled){const s=t[`${e}Data`];if(s!==void 0?o.call(t,s,r):o.call(t,r),r.cancelBubble)return}t=t._$host||t.parentNode||t.host}}function Dt(r,e,t,o,s){for(;typeof t=="function";)t=t();if(e===t)return t;const l=typeof e,h=o!==void 0;if(r=h&&t[0]&&t[0].parentNode||r,l==="string"||l==="number"){if(l==="number"&&(e=e.toString(),e===t))return t;if(h){let d=t[0];d&&d.nodeType===3?d.data!==e&&(d.data=e):d=document.createTextNode(e),t=it(r,t,o,d)}else t!==""&&typeof t=="string"?t=r.firstChild.data=e:t=r.textContent=e}else if(e==null||l==="boolean")t=it(r,t,o);else{if(l==="function")return mt(()=>{let d=e();for(;typeof d=="function";)d=d();t=Dt(r,d,t,o)}),()=>t;if(Array.isArray(e)){const d=[],S=t&&Array.isArray(t);if(Sn(d,e,t,s))return mt(()=>t=Dt(r,d,t,o,!0)),()=>t;if(d.length===0){if(t=it(r,t,o),h)return t}else S?t.length===0?Jn(r,d,o):ii(r,t,d):(t&&it(r),Jn(r,d));t=d}else if(e.nodeType){if(Array.isArray(t)){if(h)return t=it(r,t,o,e);it(r,t,null,e)}else t==null||t===""||!r.firstChild?r.appendChild(e):r.replaceChild(e,r.firstChild);t=e}}return t}function Sn(r,e,t,o){let s=!1;for(let l=0,h=e.length;l<h;l++){let d=e[l],S=t&&t[r.length],m;if(!(d==null||d===!0||d===!1))if((m=typeof d)=="object"&&d.nodeType)r.push(d);else if(Array.isArray(d))s=Sn(r,d,S)||s;else if(m==="function")if(o){for(;typeof d=="function";)d=d();s=Sn(r,Array.isArray(d)?d:[d],Array.isArray(S)?S:[S])||s}else r.push(d),s=!0;else{const A=String(d);S&&S.nodeType===3&&S.data===A?r.push(S):r.push(document.createTextNode(A))}}return s}function Jn(r,e,t=null){for(let o=0,s=e.length;o<s;o++)r.insertBefore(e[o],t)}function it(r,e,t,o){if(t===void 0)return r.textContent="";const s=o||document.createTextNode("");if(e.length){let l=!1;for(let h=e.length-1;h>=0;h--){const d=e[h];if(s!==d){const S=d.parentNode===r;!l&&!h?S?r.replaceChild(s,d):r.insertBefore(s,t):S&&d.remove()}else l=!0}}else r.insertBefore(s,t);return[s]}const ai=!1;function wr(){let r=new Set;function e(s){return r.add(s),()=>r.delete(s)}let t=!1;function o(s,l){if(t)return!(t=!1);const h={to:s,options:l,defaultPrevented:!1,preventDefault:()=>h.defaultPrevented=!0};for(const d of r)d.listener({...h,from:d.location,retry:S=>{S&&(t=!0),d.navigate(s,{...l,resolve:!1})}});return!h.defaultPrevented}return{subscribe:e,confirm:o}}let En;function Tn(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),En=window.history.state._depth}Tn();function fi(r){return{...r,_depth:window.history.state&&window.history.state._depth}}function ci(r,e){let t=!1;return()=>{const o=En;Tn();const s=o==null?null:En-o;if(t){t=!1;return}s&&e(s)?(t=!0,window.history.go(-s)):r()}}const li=/^(?:[a-z0-9]+:)?\/\//i,ui=/^\/+|(\/)\/+$/g,mr="http://sr";function yt(r,e=!1){const t=r.replace(ui,"$1");return t?e||/^[?#]/.test(t)?t:"/"+t:""}function kt(r,e,t){if(li.test(e))return;const o=yt(r),s=t&&yt(t);let l="";return!s||e.startsWith("/")?l=o:s.toLowerCase().indexOf(o.toLowerCase())!==0?l=o+s:l=s,(l||"/")+yt(e,!l)}function di(r,e){return yt(r).replace(/\/*(\*.*)?$/g,"")+yt(e)}function _r(r){const e={};return r.searchParams.forEach((t,o)=>{e[o]=t}),e}function hi(r,e,t){const[o,s]=r.split("/*",2),l=o.split("/").filter(Boolean),h=l.length;return d=>{const S=d.split("/").filter(Boolean),m=S.length-h;if(m<0||m>0&&s===void 0&&!e)return null;const A={path:h?"":"/",params:{}},B=H=>t===void 0?void 0:t[H];for(let H=0;H<h;H++){const te=l[H],le=S[H],Y=te[0]===":",ee=Y?te.slice(1):te;if(Y&&vn(le,B(ee)))A.params[ee]=le;else if(Y||!vn(le,te))return null;A.path+=`/${le}`}if(s){const H=m?S.slice(-m).join("/"):"";if(vn(H,B(s)))A.params[s]=H;else return null}return A}}function vn(r,e){const t=o=>o.localeCompare(r,void 0,{sensitivity:"base"})===0;return e===void 0?!0:typeof e=="string"?t(e):typeof e=="function"?e(r):Array.isArray(e)?e.some(t):e instanceof RegExp?e.test(r):!1}function gi(r){const[e,t]=r.pattern.split("/*",2),o=e.split("/").filter(Boolean);return o.reduce((s,l)=>s+(l.startsWith(":")?2:3),o.length-(t===void 0?0:1))}function Sr(r){const e=new Map,t=ar();return new Proxy({},{get(o,s){return e.has(s)||fr(t,()=>e.set(s,Ce(()=>r()[s]))),e.get(s)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(r())}})}function Er(r){let e=/(\/?\:[^\/]+)\?/.exec(r);if(!e)return[r];let t=r.slice(0,e.index),o=r.slice(e.index+e[0].length);const s=[t,t+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(o);)s.push(t+=e[1]),o=o.slice(e[0].length);return Er(o).reduce((l,h)=>[...l,...s.map(d=>d+h)],[])}const xi=100,vi=cr(),Cr=cr();function pi(r,e=""){const{component:t,preload:o,load:s,children:l,info:h}=r,d=!l||Array.isArray(l)&&!l.length,S={key:r,component:t,preload:o||s,info:h};return Ar(r.path).reduce((m,A)=>{for(const B of Er(A)){const H=di(e,B);let te=d?H:H.split("/*",1)[0];te=te.split("/").map(le=>le.startsWith(":")||le.startsWith("*")?le:encodeURIComponent(le)).join("/"),m.push({...S,originalPath:A,pattern:te,matcher:hi(te,!d,r.matchFilters)})}return m},[])}function yi(r,e=0){return{routes:r,score:gi(r[r.length-1])*1e4-e,matcher(t){const o=[];for(let s=r.length-1;s>=0;s--){const l=r[s],h=l.matcher(t);if(!h)return null;o.unshift({...h,route:l})}return o}}}function Ar(r){return Array.isArray(r)?r:[r]}function Rr(r,e="",t=[],o=[]){const s=Ar(r);for(let l=0,h=s.length;l<h;l++){const d=s[l];if(d&&typeof d=="object"){d.hasOwnProperty("path")||(d.path="");const S=pi(d,e);for(const m of S){t.push(m);const A=Array.isArray(d.children)&&d.children.length===0;if(d.children&&!A)Rr(d.children,m.pattern,t,o);else{const B=yi([...t],o.length);o.push(B)}t.pop()}}}return t.length?o:o.sort((l,h)=>h.score-l.score)}function pn(r,e){for(let t=0,o=r.length;t<o;t++){const s=r[t].matcher(e);if(s)return s}return[]}function bi(r,e){const t=new URL(mr),o=Ce(S=>{const m=r();try{return new URL(m,t)}catch{return console.error(`Invalid path ${m}`),S}},t,{equals:(S,m)=>S.href===m.href}),s=Ce(()=>o().pathname),l=Ce(()=>o().search,!0),h=Ce(()=>o().hash),d=()=>"";return{get pathname(){return s()},get search(){return l()},get hash(){return h()},get state(){return e()},get key(){return d()},query:Sr(Rn(l,()=>_r(o())))}}let Ve;function wi(){return Ve}function mi(r,e,t,o={}){const{signal:[s,l],utils:h={}}=r,d=h.parsePath||(ce=>ce),S=h.renderPath||(ce=>ce),m=h.beforeLeave||wr(),A=kt("",o.base||"");if(A===void 0)throw new Error(`${A} is not a valid base path`);A&&!s().value&&l({value:A,replace:!0,scroll:!1});const[B,H]=ot(!1);let te;const le=(ce,ge)=>{ge.value===Y()&&ge.state===ue()||(te===void 0&&H(!0),Ve=ce,te=ge,Hr(()=>{te===ge&&(ee(te.value),de(te.state),Be[1]([]))}).finally(()=>{te===ge&&Gr(()=>{Ve=void 0,ce==="navigate"&&tt(te),H(!1),te=void 0})}))},[Y,ee]=ot(s().value),[ue,de]=ot(s().state),Ye=bi(Y,ue),Re=[],Be=ot([]),Te=Ce(()=>typeof o.transformUrl=="function"?pn(e(),o.transformUrl(Ye.pathname)):pn(e(),Ye.pathname)),Ct=Sr(()=>{const ce=Te(),ge={};for(let Ue=0;Ue<ce.length;Ue++)Object.assign(ge,ce[Ue].params);return ge}),lt={pattern:A,path:()=>A,outlet:()=>null,resolvePath(ce){return kt(A,ce)}};return mt(Rn(s,ce=>le("native",ce),{defer:!0})),{base:lt,location:Ye,params:Ct,isRouting:B,renderPath:S,parsePath:d,navigatorFactory:ut,matches:Te,beforeLeave:m,preloadRoute:dt,singleFlight:o.singleFlight===void 0?!0:o.singleFlight,submissions:Be};function At(ce,ge,Ue){qe(()=>{if(typeof ge=="number"){ge&&(h.go?h.go(ge):console.warn("Router integration does not support relative routing"));return}const{replace:Le,resolve:ze,scroll:je,state:Ne}={replace:!1,resolve:!0,scroll:!0,...Ue},Fe=ze?ce.resolvePath(ge):kt("",ge);if(Fe===void 0)throw new Error(`Path '${ge}' is not a routable path`);if(Re.length>=xi)throw new Error("Too many redirects");const ht=Y();(Fe!==ht||Ne!==ue())&&(ai||m.confirm(Fe,Ue)&&(Re.push({value:ht,replace:Le,scroll:je,state:ue()}),le("navigate",{value:Fe,state:Ne})))})}function ut(ce){return ce=ce||Jr(Cr)||lt,(ge,Ue)=>At(ce,ge,Ue)}function tt(ce){const ge=Re[0];ge&&(l({...ce,replace:ge.replace,scroll:ge.scroll}),Re.length=0)}function dt(ce,ge={}){const Ue=pn(e(),ce.pathname),Le=Ve;Ve="preload";for(let ze in Ue){const{route:je,params:Ne}=Ue[ze];je.component&&je.component.preload&&je.component.preload();const{preload:Fe}=je;ge.preloadData&&Fe&&fr(t(),()=>Fe({params:Ne,location:{pathname:ce.pathname,search:ce.search,hash:ce.hash,query:_r(ce),state:null,key:""},intent:"preload"}))}Ve=Le}}function _i(r,e,t,o){const{base:s,location:l,params:h}=r,{pattern:d,component:S,preload:m}=o().route,A=Ce(()=>o().path);S&&S.preload&&S.preload();const B=m?m({params:h,location:l,intent:Ve||"initial"}):void 0;return{parent:e,pattern:d,path:A,outlet:()=>S?Me(S,{params:h,location:l,data:B,get children(){return t()}}):t(),resolvePath(te){return kt(s.path(),te,A())}}}const Si=r=>e=>{const{base:t}=e,o=Un(()=>e.children),s=Ce(()=>Rr(o(),e.base||""));let l;const h=mi(r,s,()=>l,{base:t,singleFlight:e.singleFlight,transformUrl:e.transformUrl});return r.create&&r.create(h),Me(vi.Provider,{value:h,get children(){return Me(Ei,{routerState:h,get root(){return e.root},get preload(){return e.rootPreload||e.rootLoad},get children(){return[Ce(()=>(l=ar())&&null),Me(Ci,{routerState:h,get branches(){return s()}})]}})}})};function Ei(r){const e=r.routerState.location,t=r.routerState.params,o=Ce(()=>r.preload&&qe(()=>{r.preload({params:t,location:e,intent:wi()||"initial"})}));return Me(vr,{get when(){return r.root},keyed:!0,get fallback(){return r.children},children:s=>Me(s,{params:t,location:e,get data(){return o()},get children(){return r.children}})})}function Ci(r){const e=[];let t;const o=Ce(Rn(r.routerState.matches,(s,l,h)=>{let d=l&&s.length===l.length;const S=[];for(let m=0,A=s.length;m<A;m++){const B=l&&l[m],H=s[m];h&&B&&H.route.key===B.route.key?S[m]=h[m]:(d=!1,e[m]&&e[m](),or(te=>{e[m]=te,S[m]=_i(r.routerState,S[m-1]||r.routerState.base,zn(()=>o()[m+1]),()=>r.routerState.matches()[m])}))}return e.splice(s.length).forEach(m=>m()),h&&d?h:(t=S[0],S)}));return zn(()=>o()&&t)()}const zn=r=>()=>Me(vr,{get when(){return r()},keyed:!0,children:e=>Me(Cr.Provider,{value:e,get children(){return e.outlet()}})}),Xn=r=>{const e=Un(()=>r.children);return ni(r,{get children(){return e()}})};function Ai([r,e],t,o){return[r,o?s=>e(o(s)):e]}function Ri(r){if(r==="#")return null;try{return document.querySelector(r)}catch{return null}}function Ui(r){let e=!1;const t=s=>typeof s=="string"?{value:s}:s,o=Ai(ot(t(r.get()),{equals:(s,l)=>s.value===l.value&&s.state===l.state}),void 0,s=>(!e&&r.set(s),s));return r.init&&sr(r.init((s=r.get())=>{e=!0,o[1](t(s)),e=!1})),Si({signal:o,create:r.create,utils:r.utils})}function Pi(r,e,t){return r.addEventListener(e,t),()=>r.removeEventListener(e,t)}function Ti(r,e){const t=Ri(`#${r}`);t?t.scrollIntoView():e&&window.scrollTo(0,0)}const Li=new Map;function ji(r=!0,e=!1,t="/_server",o){return s=>{const l=s.base.path(),h=s.navigatorFactory(s.base);let d={};function S(Y){return Y.namespaceURI==="http://www.w3.org/2000/svg"}function m(Y){if(Y.defaultPrevented||Y.button!==0||Y.metaKey||Y.altKey||Y.ctrlKey||Y.shiftKey)return;const ee=Y.composedPath().find(Te=>Te instanceof Node&&Te.nodeName.toUpperCase()==="A");if(!ee||e&&!ee.hasAttribute("link"))return;const ue=S(ee),de=ue?ee.href.baseVal:ee.href;if((ue?ee.target.baseVal:ee.target)||!de&&!ee.hasAttribute("state"))return;const Re=(ee.getAttribute("rel")||"").split(/\s+/);if(ee.hasAttribute("download")||Re&&Re.includes("external"))return;const Be=ue?new URL(de,document.baseURI):new URL(de);if(!(Be.origin!==window.location.origin||l&&Be.pathname&&!Be.pathname.toLowerCase().startsWith(l.toLowerCase())))return[ee,Be]}function A(Y){const ee=m(Y);if(!ee)return;const[ue,de]=ee,Ye=s.parsePath(de.pathname+de.search+de.hash),Re=ue.getAttribute("state");Y.preventDefault(),h(Ye,{resolve:!1,replace:ue.hasAttribute("replace"),scroll:!ue.hasAttribute("noscroll"),state:Re&&JSON.parse(Re)})}function B(Y){const ee=m(Y);if(!ee)return;const[ue,de]=ee;typeof o=="function"&&(de.pathname=o(de.pathname)),d[de.pathname]||s.preloadRoute(de,{preloadData:ue.getAttribute("preload")!=="false"})}function H(Y){const ee=m(Y);if(!ee)return;const[ue,de]=ee;typeof o=="function"&&(de.pathname=o(de.pathname)),!d[de.pathname]&&(d[de.pathname]=setTimeout(()=>{s.preloadRoute(de,{preloadData:ue.getAttribute("preload")!=="false"}),delete d[de.pathname]},200))}function te(Y){const ee=m(Y);if(!ee)return;const[,ue]=ee;typeof o=="function"&&(ue.pathname=o(ue.pathname)),d[ue.pathname]&&(clearTimeout(d[ue.pathname]),delete d[ue.pathname])}function le(Y){if(Y.defaultPrevented)return;let ee=Y.submitter&&Y.submitter.hasAttribute("formaction")?Y.submitter.getAttribute("formaction"):Y.target.getAttribute("action");if(!ee)return;if(!ee.startsWith("https://action/")){const de=new URL(ee,mr);if(ee=s.parsePath(de.pathname+de.search),!ee.startsWith(t))return}if(Y.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const ue=Li.get(ee);if(ue){Y.preventDefault();const de=new FormData(Y.target,Y.submitter);ue.call({r:s,f:Y.target},Y.target.enctype==="multipart/form-data"?de:new URLSearchParams(de))}}yr(["click","submit"]),document.addEventListener("click",A),r&&(document.addEventListener("mouseover",H),document.addEventListener("mouseout",te),document.addEventListener("focusin",B),document.addEventListener("touchstart",B)),document.addEventListener("submit",le),sr(()=>{document.removeEventListener("click",A),r&&(document.removeEventListener("mouseover",H),document.removeEventListener("mouseout",te),document.removeEventListener("focusin",B),document.removeEventListener("touchstart",B)),document.removeEventListener("submit",le)})}}function Ii(r){const e=()=>{const o=window.location.pathname.replace(/^\/+/,"/")+window.location.search;return{value:r.transformUrl?r.transformUrl(o)+window.location.hash:o+window.location.hash,state:window.history.state}},t=wr();return Ui({get:e,set({value:o,replace:s,scroll:l,state:h}){s?window.history.replaceState(fi(h),"",o):window.history.pushState(h,"",o),Ti(decodeURIComponent(window.location.hash.slice(1)),l),Tn()},init:o=>Pi(window,"popstate",ci(o,s=>{if(s&&s<0)return!t.confirm(s);{const l=e();return!t.confirm(l.value,{state:l.state})}})),create:ji(r.preload,r.explicitLinks,r.actionBase,r.transformUrl),utils:{go:o=>window.history.go(o),beforeLeave:t}})(r)}var Bi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ur(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function Wi(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var t=function o(){return this instanceof o?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(o){var s=Object.getOwnPropertyDescriptor(r,o);Object.defineProperty(t,o,s.get?s:{enumerable:!0,get:function(){return r[o]}})}),t}var Pr={exports:{}};(function(r){(function(e,t){r.exports?r.exports=t():(e.nacl||(e.nacl={}),e.nacl.util=t())})(Bi,function(){var e={};function t(o){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(o))throw new TypeError("invalid encoding")}return e.decodeUTF8=function(o){if(typeof o!="string")throw new TypeError("expected string");var s,l=unescape(encodeURIComponent(o)),h=new Uint8Array(l.length);for(s=0;s<l.length;s++)h[s]=l.charCodeAt(s);return h},e.encodeUTF8=function(o){var s,l=[];for(s=0;s<o.length;s++)l.push(String.fromCharCode(o[s]));return decodeURIComponent(escape(l.join("")))},typeof atob>"u"?typeof Buffer.from<"u"?(e.encodeBase64=function(o){return Buffer.from(o).toString("base64")},e.decodeBase64=function(o){return t(o),new Uint8Array(Array.prototype.slice.call(Buffer.from(o,"base64"),0))}):(e.encodeBase64=function(o){return new Buffer(o).toString("base64")},e.decodeBase64=function(o){return t(o),new Uint8Array(Array.prototype.slice.call(new Buffer(o,"base64"),0))}):(e.encodeBase64=function(o){var s,l=[],h=o.length;for(s=0;s<h;s++)l.push(String.fromCharCode(o[s]));return btoa(l.join(""))},e.decodeBase64=function(o){t(o);var s,l=atob(o),h=new Uint8Array(l.length);for(s=0;s<l.length;s++)h[s]=l.charCodeAt(s);return h}),e})})(Pr);var Mi=Pr.exports;const _t=Ur(Mi);function Ni(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Tr={exports:{}};const ki={},Ki=Object.freeze(Object.defineProperty({__proto__:null,default:ki},Symbol.toStringTag,{value:"Module"})),Oi=Wi(Ki);(function(r){(function(e){var t=function(i){var f,a=new Float64Array(16);if(i)for(f=0;f<i.length;f++)a[f]=i[f];return a},o=function(){throw new Error("no PRNG")},s=new Uint8Array(16),l=new Uint8Array(32);l[0]=9;var h=t(),d=t([1]),S=t([56129,1]),m=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),A=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),B=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),H=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),te=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function le(i,f,a,n){i[f]=a>>24&255,i[f+1]=a>>16&255,i[f+2]=a>>8&255,i[f+3]=a&255,i[f+4]=n>>24&255,i[f+5]=n>>16&255,i[f+6]=n>>8&255,i[f+7]=n&255}function Y(i,f,a,n,c){var g,x=0;for(g=0;g<c;g++)x|=i[f+g]^a[n+g];return(1&x-1>>>8)-1}function ee(i,f,a,n){return Y(i,f,a,n,16)}function ue(i,f,a,n){return Y(i,f,a,n,32)}function de(i,f,a,n){for(var c=n[0]&255|(n[1]&255)<<8|(n[2]&255)<<16|(n[3]&255)<<24,g=a[0]&255|(a[1]&255)<<8|(a[2]&255)<<16|(a[3]&255)<<24,x=a[4]&255|(a[5]&255)<<8|(a[6]&255)<<16|(a[7]&255)<<24,b=a[8]&255|(a[9]&255)<<8|(a[10]&255)<<16|(a[11]&255)<<24,C=a[12]&255|(a[13]&255)<<8|(a[14]&255)<<16|(a[15]&255)<<24,M=n[4]&255|(n[5]&255)<<8|(n[6]&255)<<16|(n[7]&255)<<24,U=f[0]&255|(f[1]&255)<<8|(f[2]&255)<<16|(f[3]&255)<<24,oe=f[4]&255|(f[5]&255)<<8|(f[6]&255)<<16|(f[7]&255)<<24,T=f[8]&255|(f[9]&255)<<8|(f[10]&255)<<16|(f[11]&255)<<24,O=f[12]&255|(f[13]&255)<<8|(f[14]&255)<<16|(f[15]&255)<<24,F=n[8]&255|(n[9]&255)<<8|(n[10]&255)<<16|(n[11]&255)<<24,J=a[16]&255|(a[17]&255)<<8|(a[18]&255)<<16|(a[19]&255)<<24,G=a[20]&255|(a[21]&255)<<8|(a[22]&255)<<16|(a[23]&255)<<24,D=a[24]&255|(a[25]&255)<<8|(a[26]&255)<<16|(a[27]&255)<<24,q=a[28]&255|(a[29]&255)<<8|(a[30]&255)<<16|(a[31]&255)<<24,$=n[12]&255|(n[13]&255)<<8|(n[14]&255)<<16|(n[15]&255)<<24,j=c,N=g,P=x,I=b,W=C,R=M,v=U,p=oe,_=T,y=O,w=F,E=J,k=G,z=D,Z=q,X=$,u,Q=0;Q<20;Q+=2)u=j+k|0,W^=u<<7|u>>>25,u=W+j|0,_^=u<<9|u>>>23,u=_+W|0,k^=u<<13|u>>>19,u=k+_|0,j^=u<<18|u>>>14,u=R+N|0,y^=u<<7|u>>>25,u=y+R|0,z^=u<<9|u>>>23,u=z+y|0,N^=u<<13|u>>>19,u=N+z|0,R^=u<<18|u>>>14,u=w+v|0,Z^=u<<7|u>>>25,u=Z+w|0,P^=u<<9|u>>>23,u=P+Z|0,v^=u<<13|u>>>19,u=v+P|0,w^=u<<18|u>>>14,u=X+E|0,I^=u<<7|u>>>25,u=I+X|0,p^=u<<9|u>>>23,u=p+I|0,E^=u<<13|u>>>19,u=E+p|0,X^=u<<18|u>>>14,u=j+I|0,N^=u<<7|u>>>25,u=N+j|0,P^=u<<9|u>>>23,u=P+N|0,I^=u<<13|u>>>19,u=I+P|0,j^=u<<18|u>>>14,u=R+W|0,v^=u<<7|u>>>25,u=v+R|0,p^=u<<9|u>>>23,u=p+v|0,W^=u<<13|u>>>19,u=W+p|0,R^=u<<18|u>>>14,u=w+y|0,E^=u<<7|u>>>25,u=E+w|0,_^=u<<9|u>>>23,u=_+E|0,y^=u<<13|u>>>19,u=y+_|0,w^=u<<18|u>>>14,u=X+Z|0,k^=u<<7|u>>>25,u=k+X|0,z^=u<<9|u>>>23,u=z+k|0,Z^=u<<13|u>>>19,u=Z+z|0,X^=u<<18|u>>>14;j=j+c|0,N=N+g|0,P=P+x|0,I=I+b|0,W=W+C|0,R=R+M|0,v=v+U|0,p=p+oe|0,_=_+T|0,y=y+O|0,w=w+F|0,E=E+J|0,k=k+G|0,z=z+D|0,Z=Z+q|0,X=X+$|0,i[0]=j>>>0&255,i[1]=j>>>8&255,i[2]=j>>>16&255,i[3]=j>>>24&255,i[4]=N>>>0&255,i[5]=N>>>8&255,i[6]=N>>>16&255,i[7]=N>>>24&255,i[8]=P>>>0&255,i[9]=P>>>8&255,i[10]=P>>>16&255,i[11]=P>>>24&255,i[12]=I>>>0&255,i[13]=I>>>8&255,i[14]=I>>>16&255,i[15]=I>>>24&255,i[16]=W>>>0&255,i[17]=W>>>8&255,i[18]=W>>>16&255,i[19]=W>>>24&255,i[20]=R>>>0&255,i[21]=R>>>8&255,i[22]=R>>>16&255,i[23]=R>>>24&255,i[24]=v>>>0&255,i[25]=v>>>8&255,i[26]=v>>>16&255,i[27]=v>>>24&255,i[28]=p>>>0&255,i[29]=p>>>8&255,i[30]=p>>>16&255,i[31]=p>>>24&255,i[32]=_>>>0&255,i[33]=_>>>8&255,i[34]=_>>>16&255,i[35]=_>>>24&255,i[36]=y>>>0&255,i[37]=y>>>8&255,i[38]=y>>>16&255,i[39]=y>>>24&255,i[40]=w>>>0&255,i[41]=w>>>8&255,i[42]=w>>>16&255,i[43]=w>>>24&255,i[44]=E>>>0&255,i[45]=E>>>8&255,i[46]=E>>>16&255,i[47]=E>>>24&255,i[48]=k>>>0&255,i[49]=k>>>8&255,i[50]=k>>>16&255,i[51]=k>>>24&255,i[52]=z>>>0&255,i[53]=z>>>8&255,i[54]=z>>>16&255,i[55]=z>>>24&255,i[56]=Z>>>0&255,i[57]=Z>>>8&255,i[58]=Z>>>16&255,i[59]=Z>>>24&255,i[60]=X>>>0&255,i[61]=X>>>8&255,i[62]=X>>>16&255,i[63]=X>>>24&255}function Ye(i,f,a,n){for(var c=n[0]&255|(n[1]&255)<<8|(n[2]&255)<<16|(n[3]&255)<<24,g=a[0]&255|(a[1]&255)<<8|(a[2]&255)<<16|(a[3]&255)<<24,x=a[4]&255|(a[5]&255)<<8|(a[6]&255)<<16|(a[7]&255)<<24,b=a[8]&255|(a[9]&255)<<8|(a[10]&255)<<16|(a[11]&255)<<24,C=a[12]&255|(a[13]&255)<<8|(a[14]&255)<<16|(a[15]&255)<<24,M=n[4]&255|(n[5]&255)<<8|(n[6]&255)<<16|(n[7]&255)<<24,U=f[0]&255|(f[1]&255)<<8|(f[2]&255)<<16|(f[3]&255)<<24,oe=f[4]&255|(f[5]&255)<<8|(f[6]&255)<<16|(f[7]&255)<<24,T=f[8]&255|(f[9]&255)<<8|(f[10]&255)<<16|(f[11]&255)<<24,O=f[12]&255|(f[13]&255)<<8|(f[14]&255)<<16|(f[15]&255)<<24,F=n[8]&255|(n[9]&255)<<8|(n[10]&255)<<16|(n[11]&255)<<24,J=a[16]&255|(a[17]&255)<<8|(a[18]&255)<<16|(a[19]&255)<<24,G=a[20]&255|(a[21]&255)<<8|(a[22]&255)<<16|(a[23]&255)<<24,D=a[24]&255|(a[25]&255)<<8|(a[26]&255)<<16|(a[27]&255)<<24,q=a[28]&255|(a[29]&255)<<8|(a[30]&255)<<16|(a[31]&255)<<24,$=n[12]&255|(n[13]&255)<<8|(n[14]&255)<<16|(n[15]&255)<<24,j=c,N=g,P=x,I=b,W=C,R=M,v=U,p=oe,_=T,y=O,w=F,E=J,k=G,z=D,Z=q,X=$,u,Q=0;Q<20;Q+=2)u=j+k|0,W^=u<<7|u>>>25,u=W+j|0,_^=u<<9|u>>>23,u=_+W|0,k^=u<<13|u>>>19,u=k+_|0,j^=u<<18|u>>>14,u=R+N|0,y^=u<<7|u>>>25,u=y+R|0,z^=u<<9|u>>>23,u=z+y|0,N^=u<<13|u>>>19,u=N+z|0,R^=u<<18|u>>>14,u=w+v|0,Z^=u<<7|u>>>25,u=Z+w|0,P^=u<<9|u>>>23,u=P+Z|0,v^=u<<13|u>>>19,u=v+P|0,w^=u<<18|u>>>14,u=X+E|0,I^=u<<7|u>>>25,u=I+X|0,p^=u<<9|u>>>23,u=p+I|0,E^=u<<13|u>>>19,u=E+p|0,X^=u<<18|u>>>14,u=j+I|0,N^=u<<7|u>>>25,u=N+j|0,P^=u<<9|u>>>23,u=P+N|0,I^=u<<13|u>>>19,u=I+P|0,j^=u<<18|u>>>14,u=R+W|0,v^=u<<7|u>>>25,u=v+R|0,p^=u<<9|u>>>23,u=p+v|0,W^=u<<13|u>>>19,u=W+p|0,R^=u<<18|u>>>14,u=w+y|0,E^=u<<7|u>>>25,u=E+w|0,_^=u<<9|u>>>23,u=_+E|0,y^=u<<13|u>>>19,u=y+_|0,w^=u<<18|u>>>14,u=X+Z|0,k^=u<<7|u>>>25,u=k+X|0,z^=u<<9|u>>>23,u=z+k|0,Z^=u<<13|u>>>19,u=Z+z|0,X^=u<<18|u>>>14;i[0]=j>>>0&255,i[1]=j>>>8&255,i[2]=j>>>16&255,i[3]=j>>>24&255,i[4]=R>>>0&255,i[5]=R>>>8&255,i[6]=R>>>16&255,i[7]=R>>>24&255,i[8]=w>>>0&255,i[9]=w>>>8&255,i[10]=w>>>16&255,i[11]=w>>>24&255,i[12]=X>>>0&255,i[13]=X>>>8&255,i[14]=X>>>16&255,i[15]=X>>>24&255,i[16]=v>>>0&255,i[17]=v>>>8&255,i[18]=v>>>16&255,i[19]=v>>>24&255,i[20]=p>>>0&255,i[21]=p>>>8&255,i[22]=p>>>16&255,i[23]=p>>>24&255,i[24]=_>>>0&255,i[25]=_>>>8&255,i[26]=_>>>16&255,i[27]=_>>>24&255,i[28]=y>>>0&255,i[29]=y>>>8&255,i[30]=y>>>16&255,i[31]=y>>>24&255}function Re(i,f,a,n){de(i,f,a,n)}function Be(i,f,a,n){Ye(i,f,a,n)}var Te=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function Ct(i,f,a,n,c,g,x){var b=new Uint8Array(16),C=new Uint8Array(64),M,U;for(U=0;U<16;U++)b[U]=0;for(U=0;U<8;U++)b[U]=g[U];for(;c>=64;){for(Re(C,b,x,Te),U=0;U<64;U++)i[f+U]=a[n+U]^C[U];for(M=1,U=8;U<16;U++)M=M+(b[U]&255)|0,b[U]=M&255,M>>>=8;c-=64,f+=64,n+=64}if(c>0)for(Re(C,b,x,Te),U=0;U<c;U++)i[f+U]=a[n+U]^C[U];return 0}function lt(i,f,a,n,c){var g=new Uint8Array(16),x=new Uint8Array(64),b,C;for(C=0;C<16;C++)g[C]=0;for(C=0;C<8;C++)g[C]=n[C];for(;a>=64;){for(Re(x,g,c,Te),C=0;C<64;C++)i[f+C]=x[C];for(b=1,C=8;C<16;C++)b=b+(g[C]&255)|0,g[C]=b&255,b>>>=8;a-=64,f+=64}if(a>0)for(Re(x,g,c,Te),C=0;C<a;C++)i[f+C]=x[C];return 0}function At(i,f,a,n,c){var g=new Uint8Array(32);Be(g,n,c,Te);for(var x=new Uint8Array(8),b=0;b<8;b++)x[b]=n[b+16];return lt(i,f,a,x,g)}function ut(i,f,a,n,c,g,x){var b=new Uint8Array(32);Be(b,g,x,Te);for(var C=new Uint8Array(8),M=0;M<8;M++)C[M]=g[M+16];return Ct(i,f,a,n,c,C,b)}var tt=function(i){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var f,a,n,c,g,x,b,C;f=i[0]&255|(i[1]&255)<<8,this.r[0]=f&8191,a=i[2]&255|(i[3]&255)<<8,this.r[1]=(f>>>13|a<<3)&8191,n=i[4]&255|(i[5]&255)<<8,this.r[2]=(a>>>10|n<<6)&7939,c=i[6]&255|(i[7]&255)<<8,this.r[3]=(n>>>7|c<<9)&8191,g=i[8]&255|(i[9]&255)<<8,this.r[4]=(c>>>4|g<<12)&255,this.r[5]=g>>>1&8190,x=i[10]&255|(i[11]&255)<<8,this.r[6]=(g>>>14|x<<2)&8191,b=i[12]&255|(i[13]&255)<<8,this.r[7]=(x>>>11|b<<5)&8065,C=i[14]&255|(i[15]&255)<<8,this.r[8]=(b>>>8|C<<8)&8191,this.r[9]=C>>>5&127,this.pad[0]=i[16]&255|(i[17]&255)<<8,this.pad[1]=i[18]&255|(i[19]&255)<<8,this.pad[2]=i[20]&255|(i[21]&255)<<8,this.pad[3]=i[22]&255|(i[23]&255)<<8,this.pad[4]=i[24]&255|(i[25]&255)<<8,this.pad[5]=i[26]&255|(i[27]&255)<<8,this.pad[6]=i[28]&255|(i[29]&255)<<8,this.pad[7]=i[30]&255|(i[31]&255)<<8};tt.prototype.blocks=function(i,f,a){for(var n=this.fin?0:2048,c,g,x,b,C,M,U,oe,T,O,F,J,G,D,q,$,j,N,P,I=this.h[0],W=this.h[1],R=this.h[2],v=this.h[3],p=this.h[4],_=this.h[5],y=this.h[6],w=this.h[7],E=this.h[8],k=this.h[9],z=this.r[0],Z=this.r[1],X=this.r[2],u=this.r[3],Q=this.r[4],se=this.r[5],ae=this.r[6],V=this.r[7],re=this.r[8],ie=this.r[9];a>=16;)c=i[f+0]&255|(i[f+1]&255)<<8,I+=c&8191,g=i[f+2]&255|(i[f+3]&255)<<8,W+=(c>>>13|g<<3)&8191,x=i[f+4]&255|(i[f+5]&255)<<8,R+=(g>>>10|x<<6)&8191,b=i[f+6]&255|(i[f+7]&255)<<8,v+=(x>>>7|b<<9)&8191,C=i[f+8]&255|(i[f+9]&255)<<8,p+=(b>>>4|C<<12)&8191,_+=C>>>1&8191,M=i[f+10]&255|(i[f+11]&255)<<8,y+=(C>>>14|M<<2)&8191,U=i[f+12]&255|(i[f+13]&255)<<8,w+=(M>>>11|U<<5)&8191,oe=i[f+14]&255|(i[f+15]&255)<<8,E+=(U>>>8|oe<<8)&8191,k+=oe>>>5|n,T=0,O=T,O+=I*z,O+=W*(5*ie),O+=R*(5*re),O+=v*(5*V),O+=p*(5*ae),T=O>>>13,O&=8191,O+=_*(5*se),O+=y*(5*Q),O+=w*(5*u),O+=E*(5*X),O+=k*(5*Z),T+=O>>>13,O&=8191,F=T,F+=I*Z,F+=W*z,F+=R*(5*ie),F+=v*(5*re),F+=p*(5*V),T=F>>>13,F&=8191,F+=_*(5*ae),F+=y*(5*se),F+=w*(5*Q),F+=E*(5*u),F+=k*(5*X),T+=F>>>13,F&=8191,J=T,J+=I*X,J+=W*Z,J+=R*z,J+=v*(5*ie),J+=p*(5*re),T=J>>>13,J&=8191,J+=_*(5*V),J+=y*(5*ae),J+=w*(5*se),J+=E*(5*Q),J+=k*(5*u),T+=J>>>13,J&=8191,G=T,G+=I*u,G+=W*X,G+=R*Z,G+=v*z,G+=p*(5*ie),T=G>>>13,G&=8191,G+=_*(5*re),G+=y*(5*V),G+=w*(5*ae),G+=E*(5*se),G+=k*(5*Q),T+=G>>>13,G&=8191,D=T,D+=I*Q,D+=W*u,D+=R*X,D+=v*Z,D+=p*z,T=D>>>13,D&=8191,D+=_*(5*ie),D+=y*(5*re),D+=w*(5*V),D+=E*(5*ae),D+=k*(5*se),T+=D>>>13,D&=8191,q=T,q+=I*se,q+=W*Q,q+=R*u,q+=v*X,q+=p*Z,T=q>>>13,q&=8191,q+=_*z,q+=y*(5*ie),q+=w*(5*re),q+=E*(5*V),q+=k*(5*ae),T+=q>>>13,q&=8191,$=T,$+=I*ae,$+=W*se,$+=R*Q,$+=v*u,$+=p*X,T=$>>>13,$&=8191,$+=_*Z,$+=y*z,$+=w*(5*ie),$+=E*(5*re),$+=k*(5*V),T+=$>>>13,$&=8191,j=T,j+=I*V,j+=W*ae,j+=R*se,j+=v*Q,j+=p*u,T=j>>>13,j&=8191,j+=_*X,j+=y*Z,j+=w*z,j+=E*(5*ie),j+=k*(5*re),T+=j>>>13,j&=8191,N=T,N+=I*re,N+=W*V,N+=R*ae,N+=v*se,N+=p*Q,T=N>>>13,N&=8191,N+=_*u,N+=y*X,N+=w*Z,N+=E*z,N+=k*(5*ie),T+=N>>>13,N&=8191,P=T,P+=I*ie,P+=W*re,P+=R*V,P+=v*ae,P+=p*se,T=P>>>13,P&=8191,P+=_*Q,P+=y*u,P+=w*X,P+=E*Z,P+=k*z,T+=P>>>13,P&=8191,T=(T<<2)+T|0,T=T+O|0,O=T&8191,T=T>>>13,F+=T,I=O,W=F,R=J,v=G,p=D,_=q,y=$,w=j,E=N,k=P,f+=16,a-=16;this.h[0]=I,this.h[1]=W,this.h[2]=R,this.h[3]=v,this.h[4]=p,this.h[5]=_,this.h[6]=y,this.h[7]=w,this.h[8]=E,this.h[9]=k},tt.prototype.finish=function(i,f){var a=new Uint16Array(10),n,c,g,x;if(this.leftover){for(x=this.leftover,this.buffer[x++]=1;x<16;x++)this.buffer[x]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(n=this.h[1]>>>13,this.h[1]&=8191,x=2;x<10;x++)this.h[x]+=n,n=this.h[x]>>>13,this.h[x]&=8191;for(this.h[0]+=n*5,n=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=n,n=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=n,a[0]=this.h[0]+5,n=a[0]>>>13,a[0]&=8191,x=1;x<10;x++)a[x]=this.h[x]+n,n=a[x]>>>13,a[x]&=8191;for(a[9]-=8192,c=(n^1)-1,x=0;x<10;x++)a[x]&=c;for(c=~c,x=0;x<10;x++)this.h[x]=this.h[x]&c|a[x];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,g=this.h[0]+this.pad[0],this.h[0]=g&65535,x=1;x<8;x++)g=(this.h[x]+this.pad[x]|0)+(g>>>16)|0,this.h[x]=g&65535;i[f+0]=this.h[0]>>>0&255,i[f+1]=this.h[0]>>>8&255,i[f+2]=this.h[1]>>>0&255,i[f+3]=this.h[1]>>>8&255,i[f+4]=this.h[2]>>>0&255,i[f+5]=this.h[2]>>>8&255,i[f+6]=this.h[3]>>>0&255,i[f+7]=this.h[3]>>>8&255,i[f+8]=this.h[4]>>>0&255,i[f+9]=this.h[4]>>>8&255,i[f+10]=this.h[5]>>>0&255,i[f+11]=this.h[5]>>>8&255,i[f+12]=this.h[6]>>>0&255,i[f+13]=this.h[6]>>>8&255,i[f+14]=this.h[7]>>>0&255,i[f+15]=this.h[7]>>>8&255},tt.prototype.update=function(i,f,a){var n,c;if(this.leftover){for(c=16-this.leftover,c>a&&(c=a),n=0;n<c;n++)this.buffer[this.leftover+n]=i[f+n];if(a-=c,f+=c,this.leftover+=c,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(a>=16&&(c=a-a%16,this.blocks(i,f,c),f+=c,a-=c),a){for(n=0;n<a;n++)this.buffer[this.leftover+n]=i[f+n];this.leftover+=a}};function dt(i,f,a,n,c,g){var x=new tt(g);return x.update(a,n,c),x.finish(i,f),0}function ce(i,f,a,n,c,g){var x=new Uint8Array(16);return dt(x,0,a,n,c,g),ee(i,f,x,0)}function ge(i,f,a,n,c){var g;if(a<32)return-1;for(ut(i,0,f,0,a,n,c),dt(i,16,i,32,a-32,i),g=0;g<16;g++)i[g]=0;return 0}function Ue(i,f,a,n,c){var g,x=new Uint8Array(32);if(a<32||(At(x,0,32,n,c),ce(f,16,f,32,a-32,x)!==0))return-1;for(ut(i,0,f,0,a,n,c),g=0;g<32;g++)i[g]=0;return 0}function Le(i,f){var a;for(a=0;a<16;a++)i[a]=f[a]|0}function ze(i){var f,a,n=1;for(f=0;f<16;f++)a=i[f]+n+65535,n=Math.floor(a/65536),i[f]=a-n*65536;i[0]+=n-1+37*(n-1)}function je(i,f,a){for(var n,c=~(a-1),g=0;g<16;g++)n=c&(i[g]^f[g]),i[g]^=n,f[g]^=n}function Ne(i,f){var a,n,c,g=t(),x=t();for(a=0;a<16;a++)x[a]=f[a];for(ze(x),ze(x),ze(x),n=0;n<2;n++){for(g[0]=x[0]-65517,a=1;a<15;a++)g[a]=x[a]-65535-(g[a-1]>>16&1),g[a-1]&=65535;g[15]=x[15]-32767-(g[14]>>16&1),c=g[15]>>16&1,g[14]&=65535,je(x,g,1-c)}for(a=0;a<16;a++)i[2*a]=x[a]&255,i[2*a+1]=x[a]>>8}function Fe(i,f){var a=new Uint8Array(32),n=new Uint8Array(32);return Ne(a,i),Ne(n,f),ue(a,0,n,0)}function ht(i){var f=new Uint8Array(32);return Ne(f,i),f[0]&1}function nn(i,f){var a;for(a=0;a<16;a++)i[a]=f[2*a]+(f[2*a+1]<<8);i[15]&=32767}function ke(i,f,a){for(var n=0;n<16;n++)i[n]=f[n]+a[n]}function Ke(i,f,a){for(var n=0;n<16;n++)i[n]=f[n]-a[n]}function ne(i,f,a){var n,c,g=0,x=0,b=0,C=0,M=0,U=0,oe=0,T=0,O=0,F=0,J=0,G=0,D=0,q=0,$=0,j=0,N=0,P=0,I=0,W=0,R=0,v=0,p=0,_=0,y=0,w=0,E=0,k=0,z=0,Z=0,X=0,u=a[0],Q=a[1],se=a[2],ae=a[3],V=a[4],re=a[5],ie=a[6],be=a[7],he=a[8],ve=a[9],pe=a[10],ye=a[11],we=a[12],_e=a[13],Se=a[14],Ee=a[15];n=f[0],g+=n*u,x+=n*Q,b+=n*se,C+=n*ae,M+=n*V,U+=n*re,oe+=n*ie,T+=n*be,O+=n*he,F+=n*ve,J+=n*pe,G+=n*ye,D+=n*we,q+=n*_e,$+=n*Se,j+=n*Ee,n=f[1],x+=n*u,b+=n*Q,C+=n*se,M+=n*ae,U+=n*V,oe+=n*re,T+=n*ie,O+=n*be,F+=n*he,J+=n*ve,G+=n*pe,D+=n*ye,q+=n*we,$+=n*_e,j+=n*Se,N+=n*Ee,n=f[2],b+=n*u,C+=n*Q,M+=n*se,U+=n*ae,oe+=n*V,T+=n*re,O+=n*ie,F+=n*be,J+=n*he,G+=n*ve,D+=n*pe,q+=n*ye,$+=n*we,j+=n*_e,N+=n*Se,P+=n*Ee,n=f[3],C+=n*u,M+=n*Q,U+=n*se,oe+=n*ae,T+=n*V,O+=n*re,F+=n*ie,J+=n*be,G+=n*he,D+=n*ve,q+=n*pe,$+=n*ye,j+=n*we,N+=n*_e,P+=n*Se,I+=n*Ee,n=f[4],M+=n*u,U+=n*Q,oe+=n*se,T+=n*ae,O+=n*V,F+=n*re,J+=n*ie,G+=n*be,D+=n*he,q+=n*ve,$+=n*pe,j+=n*ye,N+=n*we,P+=n*_e,I+=n*Se,W+=n*Ee,n=f[5],U+=n*u,oe+=n*Q,T+=n*se,O+=n*ae,F+=n*V,J+=n*re,G+=n*ie,D+=n*be,q+=n*he,$+=n*ve,j+=n*pe,N+=n*ye,P+=n*we,I+=n*_e,W+=n*Se,R+=n*Ee,n=f[6],oe+=n*u,T+=n*Q,O+=n*se,F+=n*ae,J+=n*V,G+=n*re,D+=n*ie,q+=n*be,$+=n*he,j+=n*ve,N+=n*pe,P+=n*ye,I+=n*we,W+=n*_e,R+=n*Se,v+=n*Ee,n=f[7],T+=n*u,O+=n*Q,F+=n*se,J+=n*ae,G+=n*V,D+=n*re,q+=n*ie,$+=n*be,j+=n*he,N+=n*ve,P+=n*pe,I+=n*ye,W+=n*we,R+=n*_e,v+=n*Se,p+=n*Ee,n=f[8],O+=n*u,F+=n*Q,J+=n*se,G+=n*ae,D+=n*V,q+=n*re,$+=n*ie,j+=n*be,N+=n*he,P+=n*ve,I+=n*pe,W+=n*ye,R+=n*we,v+=n*_e,p+=n*Se,_+=n*Ee,n=f[9],F+=n*u,J+=n*Q,G+=n*se,D+=n*ae,q+=n*V,$+=n*re,j+=n*ie,N+=n*be,P+=n*he,I+=n*ve,W+=n*pe,R+=n*ye,v+=n*we,p+=n*_e,_+=n*Se,y+=n*Ee,n=f[10],J+=n*u,G+=n*Q,D+=n*se,q+=n*ae,$+=n*V,j+=n*re,N+=n*ie,P+=n*be,I+=n*he,W+=n*ve,R+=n*pe,v+=n*ye,p+=n*we,_+=n*_e,y+=n*Se,w+=n*Ee,n=f[11],G+=n*u,D+=n*Q,q+=n*se,$+=n*ae,j+=n*V,N+=n*re,P+=n*ie,I+=n*be,W+=n*he,R+=n*ve,v+=n*pe,p+=n*ye,_+=n*we,y+=n*_e,w+=n*Se,E+=n*Ee,n=f[12],D+=n*u,q+=n*Q,$+=n*se,j+=n*ae,N+=n*V,P+=n*re,I+=n*ie,W+=n*be,R+=n*he,v+=n*ve,p+=n*pe,_+=n*ye,y+=n*we,w+=n*_e,E+=n*Se,k+=n*Ee,n=f[13],q+=n*u,$+=n*Q,j+=n*se,N+=n*ae,P+=n*V,I+=n*re,W+=n*ie,R+=n*be,v+=n*he,p+=n*ve,_+=n*pe,y+=n*ye,w+=n*we,E+=n*_e,k+=n*Se,z+=n*Ee,n=f[14],$+=n*u,j+=n*Q,N+=n*se,P+=n*ae,I+=n*V,W+=n*re,R+=n*ie,v+=n*be,p+=n*he,_+=n*ve,y+=n*pe,w+=n*ye,E+=n*we,k+=n*_e,z+=n*Se,Z+=n*Ee,n=f[15],j+=n*u,N+=n*Q,P+=n*se,I+=n*ae,W+=n*V,R+=n*re,v+=n*ie,p+=n*be,_+=n*he,y+=n*ve,w+=n*pe,E+=n*ye,k+=n*we,z+=n*_e,Z+=n*Se,X+=n*Ee,g+=38*N,x+=38*P,b+=38*I,C+=38*W,M+=38*R,U+=38*v,oe+=38*p,T+=38*_,O+=38*y,F+=38*w,J+=38*E,G+=38*k,D+=38*z,q+=38*Z,$+=38*X,c=1,n=g+c+65535,c=Math.floor(n/65536),g=n-c*65536,n=x+c+65535,c=Math.floor(n/65536),x=n-c*65536,n=b+c+65535,c=Math.floor(n/65536),b=n-c*65536,n=C+c+65535,c=Math.floor(n/65536),C=n-c*65536,n=M+c+65535,c=Math.floor(n/65536),M=n-c*65536,n=U+c+65535,c=Math.floor(n/65536),U=n-c*65536,n=oe+c+65535,c=Math.floor(n/65536),oe=n-c*65536,n=T+c+65535,c=Math.floor(n/65536),T=n-c*65536,n=O+c+65535,c=Math.floor(n/65536),O=n-c*65536,n=F+c+65535,c=Math.floor(n/65536),F=n-c*65536,n=J+c+65535,c=Math.floor(n/65536),J=n-c*65536,n=G+c+65535,c=Math.floor(n/65536),G=n-c*65536,n=D+c+65535,c=Math.floor(n/65536),D=n-c*65536,n=q+c+65535,c=Math.floor(n/65536),q=n-c*65536,n=$+c+65535,c=Math.floor(n/65536),$=n-c*65536,n=j+c+65535,c=Math.floor(n/65536),j=n-c*65536,g+=c-1+37*(c-1),c=1,n=g+c+65535,c=Math.floor(n/65536),g=n-c*65536,n=x+c+65535,c=Math.floor(n/65536),x=n-c*65536,n=b+c+65535,c=Math.floor(n/65536),b=n-c*65536,n=C+c+65535,c=Math.floor(n/65536),C=n-c*65536,n=M+c+65535,c=Math.floor(n/65536),M=n-c*65536,n=U+c+65535,c=Math.floor(n/65536),U=n-c*65536,n=oe+c+65535,c=Math.floor(n/65536),oe=n-c*65536,n=T+c+65535,c=Math.floor(n/65536),T=n-c*65536,n=O+c+65535,c=Math.floor(n/65536),O=n-c*65536,n=F+c+65535,c=Math.floor(n/65536),F=n-c*65536,n=J+c+65535,c=Math.floor(n/65536),J=n-c*65536,n=G+c+65535,c=Math.floor(n/65536),G=n-c*65536,n=D+c+65535,c=Math.floor(n/65536),D=n-c*65536,n=q+c+65535,c=Math.floor(n/65536),q=n-c*65536,n=$+c+65535,c=Math.floor(n/65536),$=n-c*65536,n=j+c+65535,c=Math.floor(n/65536),j=n-c*65536,g+=c-1+37*(c-1),i[0]=g,i[1]=x,i[2]=b,i[3]=C,i[4]=M,i[5]=U,i[6]=oe,i[7]=T,i[8]=O,i[9]=F,i[10]=J,i[11]=G,i[12]=D,i[13]=q,i[14]=$,i[15]=j}function We(i,f){ne(i,f,f)}function Mn(i,f){var a=t(),n;for(n=0;n<16;n++)a[n]=f[n];for(n=253;n>=0;n--)We(a,a),n!==2&&n!==4&&ne(a,a,f);for(n=0;n<16;n++)i[n]=a[n]}function Nn(i,f){var a=t(),n;for(n=0;n<16;n++)a[n]=f[n];for(n=250;n>=0;n--)We(a,a),n!==1&&ne(a,a,f);for(n=0;n<16;n++)i[n]=a[n]}function Rt(i,f,a){var n=new Uint8Array(32),c=new Float64Array(80),g,x,b=t(),C=t(),M=t(),U=t(),oe=t(),T=t();for(x=0;x<31;x++)n[x]=f[x];for(n[31]=f[31]&127|64,n[0]&=248,nn(c,a),x=0;x<16;x++)C[x]=c[x],U[x]=b[x]=M[x]=0;for(b[0]=U[0]=1,x=254;x>=0;--x)g=n[x>>>3]>>>(x&7)&1,je(b,C,g),je(M,U,g),ke(oe,b,M),Ke(b,b,M),ke(M,C,U),Ke(C,C,U),We(U,oe),We(T,b),ne(b,M,b),ne(M,C,oe),ke(oe,b,M),Ke(b,b,M),We(C,b),Ke(M,U,T),ne(b,M,S),ke(b,b,U),ne(M,M,b),ne(b,U,T),ne(U,C,c),We(C,oe),je(b,C,g),je(M,U,g);for(x=0;x<16;x++)c[x+16]=b[x],c[x+32]=M[x],c[x+48]=C[x],c[x+64]=U[x];var O=c.subarray(32),F=c.subarray(16);return Mn(O,O),ne(F,F,O),Ne(i,F),0}function Ut(i,f){return Rt(i,f,l)}function kn(i,f){return o(f,32),Ut(i,f)}function Pt(i,f,a){var n=new Uint8Array(32);return Rt(n,a,f),Be(i,s,n,Te)}var Kn=ge,Mr=Ue;function Nr(i,f,a,n,c,g){var x=new Uint8Array(32);return Pt(x,c,g),Kn(i,f,a,n,x)}function kr(i,f,a,n,c,g){var x=new Uint8Array(32);return Pt(x,c,g),Mr(i,f,a,n,x)}var On=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Fn(i,f,a,n){for(var c=new Int32Array(16),g=new Int32Array(16),x,b,C,M,U,oe,T,O,F,J,G,D,q,$,j,N,P,I,W,R,v,p,_,y,w,E,k=i[0],z=i[1],Z=i[2],X=i[3],u=i[4],Q=i[5],se=i[6],ae=i[7],V=f[0],re=f[1],ie=f[2],be=f[3],he=f[4],ve=f[5],pe=f[6],ye=f[7],we=0;n>=128;){for(W=0;W<16;W++)R=8*W+we,c[W]=a[R+0]<<24|a[R+1]<<16|a[R+2]<<8|a[R+3],g[W]=a[R+4]<<24|a[R+5]<<16|a[R+6]<<8|a[R+7];for(W=0;W<80;W++)if(x=k,b=z,C=Z,M=X,U=u,oe=Q,T=se,O=ae,F=V,J=re,G=ie,D=be,q=he,$=ve,j=pe,N=ye,v=ae,p=ye,_=p&65535,y=p>>>16,w=v&65535,E=v>>>16,v=(u>>>14|he<<18)^(u>>>18|he<<14)^(he>>>9|u<<23),p=(he>>>14|u<<18)^(he>>>18|u<<14)^(u>>>9|he<<23),_+=p&65535,y+=p>>>16,w+=v&65535,E+=v>>>16,v=u&Q^~u&se,p=he&ve^~he&pe,_+=p&65535,y+=p>>>16,w+=v&65535,E+=v>>>16,v=On[W*2],p=On[W*2+1],_+=p&65535,y+=p>>>16,w+=v&65535,E+=v>>>16,v=c[W%16],p=g[W%16],_+=p&65535,y+=p>>>16,w+=v&65535,E+=v>>>16,y+=_>>>16,w+=y>>>16,E+=w>>>16,P=w&65535|E<<16,I=_&65535|y<<16,v=P,p=I,_=p&65535,y=p>>>16,w=v&65535,E=v>>>16,v=(k>>>28|V<<4)^(V>>>2|k<<30)^(V>>>7|k<<25),p=(V>>>28|k<<4)^(k>>>2|V<<30)^(k>>>7|V<<25),_+=p&65535,y+=p>>>16,w+=v&65535,E+=v>>>16,v=k&z^k&Z^z&Z,p=V&re^V&ie^re&ie,_+=p&65535,y+=p>>>16,w+=v&65535,E+=v>>>16,y+=_>>>16,w+=y>>>16,E+=w>>>16,O=w&65535|E<<16,N=_&65535|y<<16,v=M,p=D,_=p&65535,y=p>>>16,w=v&65535,E=v>>>16,v=P,p=I,_+=p&65535,y+=p>>>16,w+=v&65535,E+=v>>>16,y+=_>>>16,w+=y>>>16,E+=w>>>16,M=w&65535|E<<16,D=_&65535|y<<16,z=x,Z=b,X=C,u=M,Q=U,se=oe,ae=T,k=O,re=F,ie=J,be=G,he=D,ve=q,pe=$,ye=j,V=N,W%16===15)for(R=0;R<16;R++)v=c[R],p=g[R],_=p&65535,y=p>>>16,w=v&65535,E=v>>>16,v=c[(R+9)%16],p=g[(R+9)%16],_+=p&65535,y+=p>>>16,w+=v&65535,E+=v>>>16,P=c[(R+1)%16],I=g[(R+1)%16],v=(P>>>1|I<<31)^(P>>>8|I<<24)^P>>>7,p=(I>>>1|P<<31)^(I>>>8|P<<24)^(I>>>7|P<<25),_+=p&65535,y+=p>>>16,w+=v&65535,E+=v>>>16,P=c[(R+14)%16],I=g[(R+14)%16],v=(P>>>19|I<<13)^(I>>>29|P<<3)^P>>>6,p=(I>>>19|P<<13)^(P>>>29|I<<3)^(I>>>6|P<<26),_+=p&65535,y+=p>>>16,w+=v&65535,E+=v>>>16,y+=_>>>16,w+=y>>>16,E+=w>>>16,c[R]=w&65535|E<<16,g[R]=_&65535|y<<16;v=k,p=V,_=p&65535,y=p>>>16,w=v&65535,E=v>>>16,v=i[0],p=f[0],_+=p&65535,y+=p>>>16,w+=v&65535,E+=v>>>16,y+=_>>>16,w+=y>>>16,E+=w>>>16,i[0]=k=w&65535|E<<16,f[0]=V=_&65535|y<<16,v=z,p=re,_=p&65535,y=p>>>16,w=v&65535,E=v>>>16,v=i[1],p=f[1],_+=p&65535,y+=p>>>16,w+=v&65535,E+=v>>>16,y+=_>>>16,w+=y>>>16,E+=w>>>16,i[1]=z=w&65535|E<<16,f[1]=re=_&65535|y<<16,v=Z,p=ie,_=p&65535,y=p>>>16,w=v&65535,E=v>>>16,v=i[2],p=f[2],_+=p&65535,y+=p>>>16,w+=v&65535,E+=v>>>16,y+=_>>>16,w+=y>>>16,E+=w>>>16,i[2]=Z=w&65535|E<<16,f[2]=ie=_&65535|y<<16,v=X,p=be,_=p&65535,y=p>>>16,w=v&65535,E=v>>>16,v=i[3],p=f[3],_+=p&65535,y+=p>>>16,w+=v&65535,E+=v>>>16,y+=_>>>16,w+=y>>>16,E+=w>>>16,i[3]=X=w&65535|E<<16,f[3]=be=_&65535|y<<16,v=u,p=he,_=p&65535,y=p>>>16,w=v&65535,E=v>>>16,v=i[4],p=f[4],_+=p&65535,y+=p>>>16,w+=v&65535,E+=v>>>16,y+=_>>>16,w+=y>>>16,E+=w>>>16,i[4]=u=w&65535|E<<16,f[4]=he=_&65535|y<<16,v=Q,p=ve,_=p&65535,y=p>>>16,w=v&65535,E=v>>>16,v=i[5],p=f[5],_+=p&65535,y+=p>>>16,w+=v&65535,E+=v>>>16,y+=_>>>16,w+=y>>>16,E+=w>>>16,i[5]=Q=w&65535|E<<16,f[5]=ve=_&65535|y<<16,v=se,p=pe,_=p&65535,y=p>>>16,w=v&65535,E=v>>>16,v=i[6],p=f[6],_+=p&65535,y+=p>>>16,w+=v&65535,E+=v>>>16,y+=_>>>16,w+=y>>>16,E+=w>>>16,i[6]=se=w&65535|E<<16,f[6]=pe=_&65535|y<<16,v=ae,p=ye,_=p&65535,y=p>>>16,w=v&65535,E=v>>>16,v=i[7],p=f[7],_+=p&65535,y+=p>>>16,w+=v&65535,E+=v>>>16,y+=_>>>16,w+=y>>>16,E+=w>>>16,i[7]=ae=w&65535|E<<16,f[7]=ye=_&65535|y<<16,we+=128,n-=128}return n}function Xe(i,f,a){var n=new Int32Array(8),c=new Int32Array(8),g=new Uint8Array(256),x,b=a;for(n[0]=1779033703,n[1]=3144134277,n[2]=1013904242,n[3]=2773480762,n[4]=1359893119,n[5]=2600822924,n[6]=528734635,n[7]=1541459225,c[0]=4089235720,c[1]=2227873595,c[2]=4271175723,c[3]=1595750129,c[4]=2917565137,c[5]=725511199,c[6]=4215389547,c[7]=327033209,Fn(n,c,f,a),a%=128,x=0;x<a;x++)g[x]=f[b-a+x];for(g[a]=128,a=256-128*(a<112?1:0),g[a-9]=0,le(g,a-8,b/536870912|0,b<<3),Fn(n,c,g,a),x=0;x<8;x++)le(i,8*x,n[x],c[x]);return 0}function Tt(i,f){var a=t(),n=t(),c=t(),g=t(),x=t(),b=t(),C=t(),M=t(),U=t();Ke(a,i[1],i[0]),Ke(U,f[1],f[0]),ne(a,a,U),ke(n,i[0],i[1]),ke(U,f[0],f[1]),ne(n,n,U),ne(c,i[3],f[3]),ne(c,c,A),ne(g,i[2],f[2]),ke(g,g,g),Ke(x,n,a),Ke(b,g,c),ke(C,g,c),ke(M,n,a),ne(i[0],x,b),ne(i[1],M,C),ne(i[2],C,b),ne(i[3],x,M)}function Dn(i,f,a){var n;for(n=0;n<4;n++)je(i[n],f[n],a)}function rn(i,f){var a=t(),n=t(),c=t();Mn(c,f[2]),ne(a,f[0],c),ne(n,f[1],c),Ne(i,n),i[31]^=ht(a)<<7}function on(i,f,a){var n,c;for(Le(i[0],h),Le(i[1],d),Le(i[2],d),Le(i[3],h),c=255;c>=0;--c)n=a[c/8|0]>>(c&7)&1,Dn(i,f,n),Tt(f,i),Tt(i,i),Dn(i,f,n)}function Lt(i,f){var a=[t(),t(),t(),t()];Le(a[0],B),Le(a[1],H),Le(a[2],d),ne(a[3],B,H),on(i,a,f)}function sn(i,f,a){var n=new Uint8Array(64),c=[t(),t(),t(),t()],g;for(a||o(f,32),Xe(n,f,32),n[0]&=248,n[31]&=127,n[31]|=64,Lt(c,n),rn(i,c),g=0;g<32;g++)f[g+32]=i[g];return 0}var jt=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function an(i,f){var a,n,c,g;for(n=63;n>=32;--n){for(a=0,c=n-32,g=n-12;c<g;++c)f[c]+=a-16*f[n]*jt[c-(n-32)],a=Math.floor((f[c]+128)/256),f[c]-=a*256;f[c]+=a,f[n]=0}for(a=0,c=0;c<32;c++)f[c]+=a-(f[31]>>4)*jt[c],a=f[c]>>8,f[c]&=255;for(c=0;c<32;c++)f[c]-=a*jt[c];for(n=0;n<32;n++)f[n+1]+=f[n]>>8,i[n]=f[n]&255}function fn(i){var f=new Float64Array(64),a;for(a=0;a<64;a++)f[a]=i[a];for(a=0;a<64;a++)i[a]=0;an(i,f)}function $n(i,f,a,n){var c=new Uint8Array(64),g=new Uint8Array(64),x=new Uint8Array(64),b,C,M=new Float64Array(64),U=[t(),t(),t(),t()];Xe(c,n,32),c[0]&=248,c[31]&=127,c[31]|=64;var oe=a+64;for(b=0;b<a;b++)i[64+b]=f[b];for(b=0;b<32;b++)i[32+b]=c[32+b];for(Xe(x,i.subarray(32),a+32),fn(x),Lt(U,x),rn(i,U),b=32;b<64;b++)i[b]=n[b];for(Xe(g,i,a+64),fn(g),b=0;b<64;b++)M[b]=0;for(b=0;b<32;b++)M[b]=x[b];for(b=0;b<32;b++)for(C=0;C<32;C++)M[b+C]+=g[b]*c[C];return an(i.subarray(32),M),oe}function Kr(i,f){var a=t(),n=t(),c=t(),g=t(),x=t(),b=t(),C=t();return Le(i[2],d),nn(i[1],f),We(c,i[1]),ne(g,c,m),Ke(c,c,i[2]),ke(g,i[2],g),We(x,g),We(b,x),ne(C,b,x),ne(a,C,c),ne(a,a,g),Nn(a,a),ne(a,a,c),ne(a,a,g),ne(a,a,g),ne(i[0],a,g),We(n,i[0]),ne(n,n,g),Fe(n,c)&&ne(i[0],i[0],te),We(n,i[0]),ne(n,n,g),Fe(n,c)?-1:(ht(i[0])===f[31]>>7&&Ke(i[0],h,i[0]),ne(i[3],i[0],i[1]),0)}function cn(i,f,a,n){var c,g=new Uint8Array(32),x=new Uint8Array(64),b=[t(),t(),t(),t()],C=[t(),t(),t(),t()];if(a<64||Kr(C,n))return-1;for(c=0;c<a;c++)i[c]=f[c];for(c=0;c<32;c++)i[c+32]=n[c];if(Xe(x,i,a),fn(x),on(b,C,x),Lt(C,f.subarray(32)),Tt(b,C),rn(g,b),a-=64,ue(f,0,g,0)){for(c=0;c<a;c++)i[c]=0;return-1}for(c=0;c<a;c++)i[c]=f[c+64];return a}var ln=32,It=24,gt=32,nt=16,xt=32,Bt=32,vt=32,pt=32,un=32,qn=It,Or=gt,Fr=nt,$e=64,Ze=32,rt=64,dn=32,hn=64;e.lowlevel={crypto_core_hsalsa20:Be,crypto_stream_xor:ut,crypto_stream:At,crypto_stream_salsa20_xor:Ct,crypto_stream_salsa20:lt,crypto_onetimeauth:dt,crypto_onetimeauth_verify:ce,crypto_verify_16:ee,crypto_verify_32:ue,crypto_secretbox:ge,crypto_secretbox_open:Ue,crypto_scalarmult:Rt,crypto_scalarmult_base:Ut,crypto_box_beforenm:Pt,crypto_box_afternm:Kn,crypto_box:Nr,crypto_box_open:kr,crypto_box_keypair:kn,crypto_hash:Xe,crypto_sign:$n,crypto_sign_keypair:sn,crypto_sign_open:cn,crypto_secretbox_KEYBYTES:ln,crypto_secretbox_NONCEBYTES:It,crypto_secretbox_ZEROBYTES:gt,crypto_secretbox_BOXZEROBYTES:nt,crypto_scalarmult_BYTES:xt,crypto_scalarmult_SCALARBYTES:Bt,crypto_box_PUBLICKEYBYTES:vt,crypto_box_SECRETKEYBYTES:pt,crypto_box_BEFORENMBYTES:un,crypto_box_NONCEBYTES:qn,crypto_box_ZEROBYTES:Or,crypto_box_BOXZEROBYTES:Fr,crypto_sign_BYTES:$e,crypto_sign_PUBLICKEYBYTES:Ze,crypto_sign_SECRETKEYBYTES:rt,crypto_sign_SEEDBYTES:dn,crypto_hash_BYTES:hn,gf:t,D:m,L:jt,pack25519:Ne,unpack25519:nn,M:ne,A:ke,S:We,Z:Ke,pow2523:Nn,add:Tt,set25519:Le,modL:an,scalarmult:on,scalarbase:Lt};function Yn(i,f){if(i.length!==ln)throw new Error("bad key size");if(f.length!==It)throw new Error("bad nonce size")}function Dr(i,f){if(i.length!==vt)throw new Error("bad public key size");if(f.length!==pt)throw new Error("bad secret key size")}function Ie(){for(var i=0;i<arguments.length;i++)if(!(arguments[i]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function Gn(i){for(var f=0;f<i.length;f++)i[f]=0}e.randomBytes=function(i){var f=new Uint8Array(i);return o(f,i),f},e.secretbox=function(i,f,a){Ie(i,f,a),Yn(a,f);for(var n=new Uint8Array(gt+i.length),c=new Uint8Array(n.length),g=0;g<i.length;g++)n[g+gt]=i[g];return ge(c,n,n.length,f,a),c.subarray(nt)},e.secretbox.open=function(i,f,a){Ie(i,f,a),Yn(a,f);for(var n=new Uint8Array(nt+i.length),c=new Uint8Array(n.length),g=0;g<i.length;g++)n[g+nt]=i[g];return n.length<32||Ue(c,n,n.length,f,a)!==0?null:c.subarray(gt)},e.secretbox.keyLength=ln,e.secretbox.nonceLength=It,e.secretbox.overheadLength=nt,e.scalarMult=function(i,f){if(Ie(i,f),i.length!==Bt)throw new Error("bad n size");if(f.length!==xt)throw new Error("bad p size");var a=new Uint8Array(xt);return Rt(a,i,f),a},e.scalarMult.base=function(i){if(Ie(i),i.length!==Bt)throw new Error("bad n size");var f=new Uint8Array(xt);return Ut(f,i),f},e.scalarMult.scalarLength=Bt,e.scalarMult.groupElementLength=xt,e.box=function(i,f,a,n){var c=e.box.before(a,n);return e.secretbox(i,f,c)},e.box.before=function(i,f){Ie(i,f),Dr(i,f);var a=new Uint8Array(un);return Pt(a,i,f),a},e.box.after=e.secretbox,e.box.open=function(i,f,a,n){var c=e.box.before(a,n);return e.secretbox.open(i,f,c)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var i=new Uint8Array(vt),f=new Uint8Array(pt);return kn(i,f),{publicKey:i,secretKey:f}},e.box.keyPair.fromSecretKey=function(i){if(Ie(i),i.length!==pt)throw new Error("bad secret key size");var f=new Uint8Array(vt);return Ut(f,i),{publicKey:f,secretKey:new Uint8Array(i)}},e.box.publicKeyLength=vt,e.box.secretKeyLength=pt,e.box.sharedKeyLength=un,e.box.nonceLength=qn,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(i,f){if(Ie(i,f),f.length!==rt)throw new Error("bad secret key size");var a=new Uint8Array($e+i.length);return $n(a,i,i.length,f),a},e.sign.open=function(i,f){if(Ie(i,f),f.length!==Ze)throw new Error("bad public key size");var a=new Uint8Array(i.length),n=cn(a,i,i.length,f);if(n<0)return null;for(var c=new Uint8Array(n),g=0;g<c.length;g++)c[g]=a[g];return c},e.sign.detached=function(i,f){for(var a=e.sign(i,f),n=new Uint8Array($e),c=0;c<n.length;c++)n[c]=a[c];return n},e.sign.detached.verify=function(i,f,a){if(Ie(i,f,a),f.length!==$e)throw new Error("bad signature size");if(a.length!==Ze)throw new Error("bad public key size");var n=new Uint8Array($e+i.length),c=new Uint8Array($e+i.length),g;for(g=0;g<$e;g++)n[g]=f[g];for(g=0;g<i.length;g++)n[g+$e]=i[g];return cn(c,n,n.length,a)>=0},e.sign.keyPair=function(){var i=new Uint8Array(Ze),f=new Uint8Array(rt);return sn(i,f),{publicKey:i,secretKey:f}},e.sign.keyPair.fromSecretKey=function(i){if(Ie(i),i.length!==rt)throw new Error("bad secret key size");for(var f=new Uint8Array(Ze),a=0;a<f.length;a++)f[a]=i[32+a];return{publicKey:f,secretKey:new Uint8Array(i)}},e.sign.keyPair.fromSeed=function(i){if(Ie(i),i.length!==dn)throw new Error("bad seed size");for(var f=new Uint8Array(Ze),a=new Uint8Array(rt),n=0;n<32;n++)a[n]=i[n];return sn(f,a,!0),{publicKey:f,secretKey:a}},e.sign.publicKeyLength=Ze,e.sign.secretKeyLength=rt,e.sign.seedLength=dn,e.sign.signatureLength=$e,e.hash=function(i){Ie(i);var f=new Uint8Array(hn);return Xe(f,i,i.length),f},e.hash.hashLength=hn,e.verify=function(i,f){return Ie(i,f),i.length===0||f.length===0||i.length!==f.length?!1:Y(i,0,f,0,i.length)===0},e.setPRNG=function(i){o=i},function(){var i=typeof self<"u"?self.crypto||self.msCrypto:null;if(i&&i.getRandomValues){var f=65536;e.setPRNG(function(a,n){var c,g=new Uint8Array(n);for(c=0;c<n;c+=f)i.getRandomValues(g.subarray(c,c+Math.min(n-c,f)));for(c=0;c<n;c++)a[c]=g[c];Gn(g)})}else typeof Ni<"u"&&(i=Oi,i&&i.randomBytes&&e.setPRNG(function(a,n){var c,g=i.randomBytes(n);for(c=0;c<n;c++)a[c]=g[c];Gn(g)}))}()})(r.exports?r.exports:self.nacl=self.nacl||{})})(Tr);var Fi=Tr.exports;const Mt=Ur(Fi);var Ge;(function(r){r[r.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",r[r.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",r[r.MANIFEST_NOT_FOUND_ERROR=2]="MANIFEST_NOT_FOUND_ERROR",r[r.MANIFEST_CONTENT_ERROR=3]="MANIFEST_CONTENT_ERROR",r[r.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",r[r.USER_REJECTS_ERROR=300]="USER_REJECTS_ERROR",r[r.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"})(Ge||(Ge={}));var Zn;(function(r){r[r.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",r[r.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"})(Zn||(Zn={}));var st;(function(r){r[r.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",r[r.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",r[r.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",r[r.USER_REJECTS_ERROR=300]="USER_REJECTS_ERROR",r[r.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"})(st||(st={}));var Vn;(function(r){r[r.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",r[r.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",r[r.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",r[r.USER_REJECTS_ERROR=300]="USER_REJECTS_ERROR",r[r.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"})(Vn||(Vn={}));var Qn;(function(r){r[r.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",r[r.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",r[r.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",r[r.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"})(Qn||(Qn={}));var er;(function(r){r.MAINNET="-239",r.TESTNET="-3"})(er||(er={}));function Di(r,e){const t=_t.encodeBase64(r);return e?encodeURIComponent(t):t}function $i(r,e){return e&&(r=decodeURIComponent(r)),_t.decodeBase64(r)}function qi(r,e=!1){let t;return r instanceof Uint8Array?t=r:(typeof r!="string"&&(r=JSON.stringify(r)),t=_t.decodeUTF8(r)),Di(t,e)}function Yi(r,e=!1){const t=$i(r,e);return{toString(){return _t.encodeUTF8(t)},toObject(){try{return JSON.parse(_t.encodeUTF8(t))}catch{return null}},toUint8Array(){return t}}}const Lr={encode:qi,decode:Yi};function Gi(r,e){const t=new Uint8Array(r.length+e.length);return t.set(r),t.set(e,r.length),t}function Hi(r,e){if(e>=r.length)throw new Error("Index is out of buffer");const t=r.slice(0,e),o=r.slice(e);return[t,o]}function yn(r){let e="";return r.forEach(t=>{e+=("0"+(t&255).toString(16)).slice(-2)}),e}function $t(r){if(r.length%2!==0)throw new Error(`Cannot convert ${r} to bytesArray`);const e=new Uint8Array(r.length/2);for(let t=0;t<r.length;t+=2)e[t/2]=parseInt(r.slice(t,t+2),16);return e}class Cn{constructor(e){this.nonceLength=24,this.keyPair=e?this.createKeypairFromString(e):this.createKeypair(),this.sessionId=yn(this.keyPair.publicKey)}createKeypair(){return Mt.box.keyPair()}createKeypairFromString(e){return{publicKey:$t(e.publicKey),secretKey:$t(e.secretKey)}}createNonce(){return Mt.randomBytes(this.nonceLength)}encrypt(e,t){const o=new TextEncoder().encode(e),s=this.createNonce(),l=Mt.box(o,s,t,this.keyPair.secretKey);return Gi(s,l)}decrypt(e,t){const[o,s]=Hi(e,this.nonceLength),l=Mt.box.open(s,o,t,this.keyPair.secretKey);if(!l)throw new Error(`Decryption error: 
 message: ${e.toString()} 
 sender pubkey: ${t.toString()} 
 keypair pubkey: ${this.keyPair.publicKey.toString()} 
 keypair secretkey: ${this.keyPair.secretKey.toString()}`);return new TextDecoder().decode(l)}stringifyKeypair(){return{publicKey:yn(this.keyPair.publicKey),secretKey:yn(this.keyPair.secretKey)}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Ji(r,e){var t={};for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&e.indexOf(o)<0&&(t[o]=r[o]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,o=Object.getOwnPropertySymbols(r);s<o.length;s++)e.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(r,o[s])&&(t[o[s]]=r[o[s]]);return t}function L(r,e,t,o){function s(l){return l instanceof t?l:new t(function(h){h(l)})}return new(t||(t=Promise))(function(l,h){function d(A){try{m(o.next(A))}catch(B){h(B)}}function S(A){try{m(o.throw(A))}catch(B){h(B)}}function m(A){A.done?l(A.value):s(A.value).then(d,S)}m((o=o.apply(r,[])).next())})}class K extends Error{constructor(e,t){super(e,t),this.message=`${K.prefix} ${this.constructor.name}${this.info?": "+this.info:""}${e?`
`+e:""}`,Object.setPrototypeOf(this,K.prototype)}get info(){return""}}K.prefix="[TON_CONNECT_SDK_ERROR]";class Ln extends K{get info(){return"Passed DappMetadata is in incorrect format."}constructor(...e){super(...e),Object.setPrototypeOf(this,Ln.prototype)}}class zt extends K{get info(){return"Passed `tonconnect-manifest.json` contains errors. Check format of your manifest. See more https://github.com/ton-connect/docs/blob/main/requests-responses.md#app-manifest"}constructor(...e){super(...e),Object.setPrototypeOf(this,zt.prototype)}}class Xt extends K{get info(){return"Manifest not found. Make sure you added `tonconnect-manifest.json` to the root of your app or passed correct manifestUrl. See more https://github.com/ton-connect/docs/blob/main/requests-responses.md#app-manifest"}constructor(...e){super(...e),Object.setPrototypeOf(this,Xt.prototype)}}class jn extends K{get info(){return"Wallet connection called but wallet already connected. To avoid the error, disconnect the wallet before doing a new connection."}constructor(...e){super(...e),Object.setPrototypeOf(this,jn.prototype)}}class qt extends K{get info(){return"Send transaction or other protocol methods called while wallet is not connected."}constructor(...e){super(...e),Object.setPrototypeOf(this,qt.prototype)}}function zi(r){return"jsBridgeKey"in r}class Zt extends K{get info(){return"User rejects the action in the wallet."}constructor(...e){super(...e),Object.setPrototypeOf(this,Zt.prototype)}}class Vt extends K{get info(){return"Request to the wallet contains errors."}constructor(...e){super(...e),Object.setPrototypeOf(this,Vt.prototype)}}class Qt extends K{get info(){return"App tries to send rpc request to the injected wallet while not connected."}constructor(...e){super(...e),Object.setPrototypeOf(this,Qt.prototype)}}class In extends K{get info(){return"There is an attempt to connect to the injected wallet while it is not exists in the webpage."}constructor(...e){super(...e),Object.setPrototypeOf(this,In.prototype)}}class Bn extends K{get info(){return"An error occurred while fetching the wallets list."}constructor(...e){super(...e),Object.setPrototypeOf(this,Bn.prototype)}}class He extends K{constructor(...e){super(...e),Object.setPrototypeOf(this,He.prototype)}}const tr={[Ge.UNKNOWN_ERROR]:He,[Ge.USER_REJECTS_ERROR]:Zt,[Ge.BAD_REQUEST_ERROR]:Vt,[Ge.UNKNOWN_APP_ERROR]:Qt,[Ge.MANIFEST_NOT_FOUND_ERROR]:Xt,[Ge.MANIFEST_CONTENT_ERROR]:zt};class Xi{parseError(e){let t=He;return e.code in tr&&(t=tr[e.code]||He),new t(e.message)}}const Zi=new Xi;class Vi{isError(e){return"error"in e}}const nr={[st.UNKNOWN_ERROR]:He,[st.USER_REJECTS_ERROR]:Zt,[st.BAD_REQUEST_ERROR]:Vt,[st.UNKNOWN_APP_ERROR]:Qt};class Qi extends Vi{convertToRpcRequest(e){return{method:"sendTransaction",params:[JSON.stringify(e)]}}parseAndThrowError(e){let t=He;throw e.error.code in nr&&(t=nr[e.error.code]||He),new t(e.error.message)}convertFromRpcResponse(e){return{boc:e.result}}}const Nt=new Qi;class eo{constructor(e,t){this.storage=e,this.storeKey="ton-connect-storage_http-bridge-gateway::"+t}storeLastEventId(e){return L(this,void 0,void 0,function*(){return this.storage.setItem(this.storeKey,e)})}removeLastEventId(){return L(this,void 0,void 0,function*(){return this.storage.removeItem(this.storeKey)})}getLastEventId(){return L(this,void 0,void 0,function*(){const e=yield this.storage.getItem(this.storeKey);return e||null})}}function to(r){return r.slice(-1)==="/"?r.slice(0,-1):r}function jr(r,e){return to(r)+"/"+e}function no(r){if(!r)return!1;const e=new URL(r);return e.protocol==="tg:"||e.hostname==="t.me"}function ro(r){return r.replaceAll(".","%2E").replaceAll("-","%2D").replaceAll("_","%5F").replaceAll("&","-").replaceAll("=","__").replaceAll("%","--")}function Ir(r,e){return L(this,void 0,void 0,function*(){return new Promise((t,o)=>{var s,l;if(!((s=void 0)===null||s===void 0)&&s.aborted){o(new K("Delay aborted"));return}const h=setTimeout(()=>t(),r);(l=void 0)===null||l===void 0||l.addEventListener("abort",()=>{clearTimeout(h),o(new K("Delay aborted"))})})})}function Oe(r){const e=new AbortController;return r?.aborted?e.abort():r?.addEventListener("abort",()=>e.abort(),{once:!0}),e}function bt(r,e){var t,o;return L(this,void 0,void 0,function*(){const s=(t=e?.attempts)!==null&&t!==void 0?t:10,l=(o=e?.delayMs)!==null&&o!==void 0?o:200,h=Oe(e?.signal);if(typeof r!="function")throw new K(`Expected a function, got ${typeof r}`);let d=0,S;for(;d<s;){if(h.signal.aborted)throw new K(`Aborted after attempts ${d}`);try{return yield r({signal:h.signal})}catch(m){S=m,d++,d<s&&(yield Ir(l))}}throw S})}function me(...r){try{console.debug("[TON_CONNECT_SDK]",...r)}catch{}}function De(...r){try{console.error("[TON_CONNECT_SDK]",...r)}catch{}}function io(...r){try{console.warn("[TON_CONNECT_SDK]",...r)}catch{}}function oo(r,e){let t=null,o=null,s=null,l=null,h=null;const d=(B,...H)=>L(this,void 0,void 0,function*(){if(l=B??null,h?.abort(),h=Oe(B),h.signal.aborted)throw new K("Resource creation was aborted");o=H??null;const te=r(h.signal,...H);s=te;const le=yield te;if(s!==te&&le!==t)throw yield e(le),new K("Resource creation was aborted by a new resource creation");return t=le,t});return{create:d,current:()=>t??null,dispose:()=>L(this,void 0,void 0,function*(){try{const B=t;t=null;const H=s;s=null;try{h?.abort()}catch{}yield Promise.allSettled([B?e(B):Promise.resolve(),H?e(yield H):Promise.resolve()])}catch{}}),recreate:B=>L(this,void 0,void 0,function*(){const H=t,te=s,le=o,Y=l;if(yield Ir(B),H===t&&te===s&&le===o&&Y===l)return yield d(l,...le??[]);throw new K("Resource recreation was aborted by a new resource creation")})}}function so(r,e){const t=e?.timeout,o=e?.signal,s=Oe(o);return new Promise((l,h)=>{if(s.signal.aborted){h(new K("Operation aborted"));return}let d;typeof t<"u"&&(d=setTimeout(()=>{s.abort(),h(new K(`Timeout after ${t}ms`))},t)),s.signal.addEventListener("abort",()=>{clearTimeout(d),h(new K("Operation aborted"))},{once:!0});const S={timeout:t,abort:s.signal};r(l,h,S).finally(()=>clearTimeout(d))})}class bn{constructor(e,t,o,s,l){this.bridgeUrl=t,this.sessionId=o,this.listener=s,this.errorsListener=l,this.ssePath="events",this.postPath="message",this.heartbeatMessage="heartbeat",this.defaultTtl=300,this.defaultReconnectDelay=5e3,this.eventSource=oo((h,d)=>L(this,void 0,void 0,function*(){const S={bridgeUrl:this.bridgeUrl,ssePath:this.ssePath,sessionId:this.sessionId,bridgeGatewayStorage:this.bridgeGatewayStorage,errorHandler:this.errorsHandler.bind(this),messageHandler:this.messagesHandler.bind(this),signal:h,openingDeadlineMS:d};return yield ao(S)}),h=>L(this,void 0,void 0,function*(){h.close()})),this.bridgeGatewayStorage=new eo(e,t)}get isReady(){const e=this.eventSource.current();return e?.readyState===EventSource.OPEN}get isClosed(){const e=this.eventSource.current();return e?.readyState!==EventSource.OPEN}get isConnecting(){const e=this.eventSource.current();return e?.readyState===EventSource.CONNECTING}registerSession(e){return L(this,void 0,void 0,function*(){yield this.eventSource.create(e?.signal,e?.openingDeadlineMS)})}send(e,t,o,s){var l;return L(this,void 0,void 0,function*(){const h={};typeof s=="number"?h.ttl=s:(h.ttl=s?.ttl,h.signal=s?.signal,h.attempts=s?.attempts);const d=new URL(jr(this.bridgeUrl,this.postPath));d.searchParams.append("client_id",this.sessionId),d.searchParams.append("to",t),d.searchParams.append("ttl",(h?.ttl||this.defaultTtl).toString()),d.searchParams.append("topic",o);const S=Lr.encode(e);yield bt(m=>L(this,void 0,void 0,function*(){const A=yield this.post(d,S,m.signal);if(!A.ok)throw new K(`Bridge send failed, status ${A.status}`)}),{attempts:(l=h?.attempts)!==null&&l!==void 0?l:Number.MAX_SAFE_INTEGER,delayMs:5e3,signal:h?.signal})})}pause(){this.eventSource.dispose().catch(e=>De(`Bridge pause failed, ${e}`))}unPause(){return L(this,void 0,void 0,function*(){yield this.eventSource.recreate(0)})}close(){return L(this,void 0,void 0,function*(){yield this.eventSource.dispose().catch(e=>De(`Bridge close failed, ${e}`))})}setListener(e){this.listener=e}setErrorsListener(e){this.errorsListener=e}post(e,t,o){return L(this,void 0,void 0,function*(){const s=yield fetch(e,{method:"post",body:t,signal:o});if(!s.ok)throw new K(`Bridge send failed, status ${s.status}`);return s})}errorsHandler(e,t){return L(this,void 0,void 0,function*(){if(this.isConnecting){De("Bridge error",JSON.stringify(t));return}if(this.isReady){try{this.errorsListener(t)}catch{}return}if(this.isClosed)return e.close(),me(`Bridge reconnecting, ${this.defaultReconnectDelay}ms delay`),yield this.eventSource.recreate(this.defaultReconnectDelay);throw new K("Bridge error, unknown state")})}messagesHandler(e){return L(this,void 0,void 0,function*(){if(e.data===this.heartbeatMessage||(yield this.bridgeGatewayStorage.storeLastEventId(e.lastEventId),this.isClosed))return;let t;try{t=JSON.parse(e.data)}catch(o){throw new K(`Bridge message parse failed, message ${o.data}`)}this.listener(t)})}}function ao(r){return L(this,void 0,void 0,function*(){return yield so((e,t,o)=>L(this,void 0,void 0,function*(){var s;const h=Oe(o.signal).signal;if(h.aborted){t(new K("Bridge connection aborted"));return}const d=new URL(jr(r.bridgeUrl,r.ssePath));d.searchParams.append("client_id",r.sessionId);const S=yield r.bridgeGatewayStorage.getLastEventId();if(S&&d.searchParams.append("last_event_id",S),h.aborted){t(new K("Bridge connection aborted"));return}const m=new EventSource(d.toString());m.onerror=A=>L(this,void 0,void 0,function*(){if(h.aborted){m.close(),t(new K("Bridge connection aborted"));return}try{const B=yield r.errorHandler(m,A);B!==m&&m.close(),B&&B!==m&&e(B)}catch(B){m.close(),t(B)}}),m.onopen=()=>{if(h.aborted){m.close(),t(new K("Bridge connection aborted"));return}e(m)},m.onmessage=A=>{if(h.aborted){m.close(),t(new K("Bridge connection aborted"));return}r.messageHandler(A)},(s=r.signal)===null||s===void 0||s.addEventListener("abort",()=>{m.close(),t(new K("Bridge connection aborted"))})}),{timeout:r.openingDeadlineMS,signal:r.signal})})}function wt(r){return!("connectEvent"in r)}class St{constructor(e){this.storage=e,this.storeKey="ton-connect-storage_bridge-connection"}storeConnection(e){return L(this,void 0,void 0,function*(){if(e.type==="injected")return this.storage.setItem(this.storeKey,JSON.stringify(e));if(!wt(e)){const o={sessionKeyPair:e.session.sessionCrypto.stringifyKeypair(),walletPublicKey:e.session.walletPublicKey,bridgeUrl:e.session.bridgeUrl},s={type:"http",connectEvent:e.connectEvent,session:o,lastWalletEventId:e.lastWalletEventId,nextRpcRequestId:e.nextRpcRequestId};return this.storage.setItem(this.storeKey,JSON.stringify(s))}const t={type:"http",connectionSource:e.connectionSource,sessionCrypto:e.sessionCrypto.stringifyKeypair()};return this.storage.setItem(this.storeKey,JSON.stringify(t))})}removeConnection(){return L(this,void 0,void 0,function*(){return this.storage.removeItem(this.storeKey)})}getConnection(){return L(this,void 0,void 0,function*(){const e=yield this.storage.getItem(this.storeKey);if(!e)return null;const t=JSON.parse(e);if(t.type==="injected")return t;if("connectEvent"in t){const o=new Cn(t.session.sessionKeyPair);return{type:"http",connectEvent:t.connectEvent,lastWalletEventId:t.lastWalletEventId,nextRpcRequestId:t.nextRpcRequestId,session:{sessionCrypto:o,bridgeUrl:t.session.bridgeUrl,walletPublicKey:t.session.walletPublicKey}}}return{type:"http",sessionCrypto:new Cn(t.sessionCrypto),connectionSource:t.connectionSource}})}getHttpConnection(){return L(this,void 0,void 0,function*(){const e=yield this.getConnection();if(!e)throw new K("Trying to read HTTP connection source while nothing is stored");if(e.type==="injected")throw new K("Trying to read HTTP connection source while injected connection is stored");return e})}getHttpPendingConnection(){return L(this,void 0,void 0,function*(){const e=yield this.getConnection();if(!e)throw new K("Trying to read HTTP connection source while nothing is stored");if(e.type==="injected")throw new K("Trying to read HTTP connection source while injected connection is stored");if(!wt(e))throw new K("Trying to read HTTP-pending connection while http connection is stored");return e})}getInjectedConnection(){return L(this,void 0,void 0,function*(){const e=yield this.getConnection();if(!e)throw new K("Trying to read Injected bridge connection source while nothing is stored");if(e?.type==="http")throw new K("Trying to read Injected bridge connection source while HTTP connection is stored");return e})}storedConnectionType(){return L(this,void 0,void 0,function*(){const e=yield this.storage.getItem(this.storeKey);return e?JSON.parse(e).type:null})}storeLastWalletEventId(e){return L(this,void 0,void 0,function*(){const t=yield this.getConnection();if(t&&t.type==="http"&&!wt(t))return t.lastWalletEventId=e,this.storeConnection(t)})}getLastWalletEventId(){return L(this,void 0,void 0,function*(){const e=yield this.getConnection();if(e&&"lastWalletEventId"in e)return e.lastWalletEventId})}increaseNextRpcRequestId(){return L(this,void 0,void 0,function*(){const e=yield this.getConnection();if(e&&"nextRpcRequestId"in e){const t=e.nextRpcRequestId||0;return e.nextRpcRequestId=t+1,this.storeConnection(e)}})}getNextRpcRequestId(){return L(this,void 0,void 0,function*(){const e=yield this.getConnection();return e&&"nextRpcRequestId"in e&&e.nextRpcRequestId||0})}}const Br=2;class Et{constructor(e,t){this.storage=e,this.walletConnectionSource=t,this.type="http",this.standardUniversalLink="tc://",this.pendingRequests=new Map,this.session=null,this.gateway=null,this.pendingGateways=[],this.listeners=[],this.defaultOpeningDeadlineMS=5e3,this.connectionStorage=new St(e)}static fromStorage(e){return L(this,void 0,void 0,function*(){const o=yield new St(e).getHttpConnection();return wt(o)?new Et(e,o.connectionSource):new Et(e,{bridgeUrl:o.session.bridgeUrl})})}connect(e,t){var o;const s=Oe(t?.signal);(o=this.abortController)===null||o===void 0||o.abort(),this.abortController=s,this.closeGateways();const l=new Cn;this.session={sessionCrypto:l,bridgeUrl:"bridgeUrl"in this.walletConnectionSource?this.walletConnectionSource.bridgeUrl:""},this.connectionStorage.storeConnection({type:"http",connectionSource:this.walletConnectionSource,sessionCrypto:l}).then(()=>L(this,void 0,void 0,function*(){s.signal.aborted||(yield bt(d=>this.openGateways(l,{openingDeadlineMS:t?.openingDeadlineMS,signal:d?.signal}),{attempts:Number.MAX_SAFE_INTEGER,delayMs:5e3,signal:s.signal}))}));const h="universalLink"in this.walletConnectionSource&&this.walletConnectionSource.universalLink?this.walletConnectionSource.universalLink:this.standardUniversalLink;return this.generateUniversalLink(h,e)}restoreConnection(e){var t,o;return L(this,void 0,void 0,function*(){const s=Oe(e?.signal);if((t=this.abortController)===null||t===void 0||t.abort(),this.abortController=s,s.signal.aborted)return;this.closeGateways();const l=yield this.connectionStorage.getHttpConnection();if(!l||s.signal.aborted)return;const h=(o=e?.openingDeadlineMS)!==null&&o!==void 0?o:this.defaultOpeningDeadlineMS;if(wt(l))return this.session={sessionCrypto:l.sessionCrypto,bridgeUrl:"bridgeUrl"in this.walletConnectionSource?this.walletConnectionSource.bridgeUrl:""},yield this.openGateways(l.sessionCrypto,{openingDeadlineMS:h,signal:s?.signal});if(Array.isArray(this.walletConnectionSource))throw new K("Internal error. Connection source is array while WalletConnectionSourceHTTP was expected.");if(this.session=l.session,this.gateway&&(me("Gateway is already opened, closing previous gateway"),yield this.gateway.close()),this.gateway=new bn(this.storage,this.walletConnectionSource.bridgeUrl,l.session.sessionCrypto.sessionId,this.gatewayListener.bind(this),this.gatewayErrorsListener.bind(this)),!s.signal.aborted){this.listeners.forEach(d=>d(l.connectEvent));try{yield bt(d=>this.gateway.registerSession({openingDeadlineMS:h,signal:d.signal}),{attempts:Number.MAX_SAFE_INTEGER,delayMs:5e3,signal:s.signal})}catch{yield this.disconnect({signal:s.signal});return}}})}sendRequest(e,t){const o={};return typeof t=="function"?o.onRequestSent=t:(o.onRequestSent=t?.onRequestSent,o.signal=t?.signal,o.attempts=t?.attempts),new Promise((s,l)=>L(this,void 0,void 0,function*(){var h;if(!this.gateway||!this.session||!("walletPublicKey"in this.session))throw new K("Trying to send bridge request without session");const d=(yield this.connectionStorage.getNextRpcRequestId()).toString();yield this.connectionStorage.increaseNextRpcRequestId(),me("Send http-bridge request:",Object.assign(Object.assign({},e),{id:d}));const S=this.session.sessionCrypto.encrypt(JSON.stringify(Object.assign(Object.assign({},e),{id:d})),$t(this.session.walletPublicKey));try{yield this.gateway.send(S,this.session.walletPublicKey,e.method,{attempts:o?.attempts,signal:o?.signal}),(h=o?.onRequestSent)===null||h===void 0||h.call(o),this.pendingRequests.set(d.toString(),s)}catch(m){l(m)}}))}closeConnection(){this.closeGateways(),this.listeners=[],this.session=null,this.gateway=null}disconnect(e){return L(this,void 0,void 0,function*(){return new Promise(t=>L(this,void 0,void 0,function*(){let o=!1,s=null;const l=()=>{o||(o=!0,this.removeBridgeAndSession().then(t))};try{this.closeGateways();const h=Oe(e?.signal);s=setTimeout(()=>{h.abort()},this.defaultOpeningDeadlineMS),yield this.sendRequest({method:"disconnect",params:[]},{onRequestSent:l,signal:h.signal,attempts:1})}catch(h){me("Disconnect error:",h),o||this.removeBridgeAndSession().then(t)}finally{s&&clearTimeout(s),l()}}))})}listen(e){return this.listeners.push(e),()=>this.listeners=this.listeners.filter(t=>t!==e)}pause(){var e;(e=this.gateway)===null||e===void 0||e.pause(),this.pendingGateways.forEach(t=>t.pause())}unPause(){return L(this,void 0,void 0,function*(){const e=this.pendingGateways.map(t=>t.unPause());this.gateway&&e.push(this.gateway.unPause()),yield Promise.all(e)})}pendingGatewaysListener(e,t,o){return L(this,void 0,void 0,function*(){if(!this.pendingGateways.includes(e)){yield e.close();return}return this.closeGateways({except:e}),this.gateway&&(me("Gateway is already opened, closing previous gateway"),yield this.gateway.close()),this.session.bridgeUrl=t,this.gateway=e,this.gateway.setErrorsListener(this.gatewayErrorsListener.bind(this)),this.gateway.setListener(this.gatewayListener.bind(this)),this.gatewayListener(o)})}gatewayListener(e){return L(this,void 0,void 0,function*(){const t=JSON.parse(this.session.sessionCrypto.decrypt(Lr.decode(e.message).toUint8Array(),$t(e.from)));if(me("Wallet message received:",t),!("event"in t)){const s=t.id.toString(),l=this.pendingRequests.get(s);if(!l){me(`Response id ${s} doesn't match any request's id`);return}l(t),this.pendingRequests.delete(s);return}if(t.id!==void 0){const s=yield this.connectionStorage.getLastWalletEventId();if(s!==void 0&&t.id<=s){De(`Received event id (=${t.id}) must be greater than stored last wallet event id (=${s}) `);return}t.event!=="connect"&&(yield this.connectionStorage.storeLastWalletEventId(t.id))}const o=this.listeners;t.event==="connect"&&(yield this.updateSession(t,e.from)),t.event==="disconnect"&&(me("Removing bridge and session: received disconnect event"),yield this.removeBridgeAndSession()),o.forEach(s=>s(t))})}gatewayErrorsListener(e){return L(this,void 0,void 0,function*(){throw new K(`Bridge error ${JSON.stringify(e)}`)})}updateSession(e,t){return L(this,void 0,void 0,function*(){this.session=Object.assign(Object.assign({},this.session),{walletPublicKey:t});const o=e.payload.items.find(l=>l.name==="ton_addr"),s=Object.assign(Object.assign({},e),{payload:Object.assign(Object.assign({},e.payload),{items:[o]})});yield this.connectionStorage.storeConnection({type:"http",session:this.session,lastWalletEventId:e.id,connectEvent:s,nextRpcRequestId:0})})}removeBridgeAndSession(){return L(this,void 0,void 0,function*(){this.closeConnection(),yield this.connectionStorage.removeConnection()})}generateUniversalLink(e,t){return no(e)?this.generateTGUniversalLink(e,t):this.generateRegularUniversalLink(e,t)}generateRegularUniversalLink(e,t){const o=new URL(e);return o.searchParams.append("v",Br.toString()),o.searchParams.append("id",this.session.sessionCrypto.sessionId),o.searchParams.append("r",JSON.stringify(t)),o.toString()}generateTGUniversalLink(e,t){const s=this.generateRegularUniversalLink("about:blank",t).split("?")[1],l="tonconnect-"+ro(s),h=this.convertToDirectLink(e),d=new URL(h);return d.searchParams.append("startapp",l),d.toString()}convertToDirectLink(e){const t=new URL(e);return t.searchParams.has("attach")&&(t.searchParams.delete("attach"),t.pathname+="/start"),t.toString()}openGateways(e,t){return L(this,void 0,void 0,function*(){if(Array.isArray(this.walletConnectionSource)){this.pendingGateways.map(o=>o.close().catch()),this.pendingGateways=this.walletConnectionSource.map(o=>{const s=new bn(this.storage,o.bridgeUrl,e.sessionId,()=>{},()=>{});return s.setListener(l=>this.pendingGatewaysListener(s,o.bridgeUrl,l)),s}),yield Promise.allSettled(this.pendingGateways.map(o=>bt(s=>this.pendingGateways.some(l=>l===o)?o.registerSession({openingDeadlineMS:t?.openingDeadlineMS,signal:s.signal}):o.close(),{attempts:Number.MAX_SAFE_INTEGER,delayMs:5e3,signal:t?.signal})));return}else return this.gateway&&(me("Gateway is already opened, closing previous gateway"),yield this.gateway.close()),this.gateway=new bn(this.storage,this.walletConnectionSource.bridgeUrl,e.sessionId,this.gatewayListener.bind(this),this.gatewayErrorsListener.bind(this)),yield this.gateway.registerSession({openingDeadlineMS:t?.openingDeadlineMS,signal:t?.signal})})}closeGateways(e){var t;(t=this.gateway)===null||t===void 0||t.close(),this.pendingGateways.filter(o=>o!==e?.except).forEach(o=>o.close()),this.pendingGateways=[]}}function rr(r,e){return Wr(r,[e])}function Wr(r,e){return!r||typeof r!="object"?!1:e.every(t=>t in r)}function fo(r){try{return!rr(r,"tonconnect")||!rr(r.tonconnect,"walletInfo")?!1:Wr(r.tonconnect.walletInfo,["name","app_name","image","about_url","platforms"])}catch{return!1}}class at{constructor(){this.storage={}}static getInstance(){return at.instance||(at.instance=new at),at.instance}get length(){return Object.keys(this.storage).length}clear(){this.storage={}}getItem(e){var t;return(t=this.storage[e])!==null&&t!==void 0?t:null}key(e){var t;const o=Object.keys(this.storage);return e<0||e>=o.length?null:(t=o[e])!==null&&t!==void 0?t:null}removeItem(e){delete this.storage[e]}setItem(e,t){this.storage[e]=t}}function en(){if(!(typeof window>"u"))return window}function co(){const r=en();if(!r)return[];try{return Object.keys(r)}catch{return[]}}function lo(){if(!(typeof document>"u"))return document}function uo(){var r;const e=(r=en())===null||r===void 0?void 0:r.location.origin;return e?e+"/tonconnect-manifest.json":""}function ho(){if(go())return localStorage;if(xo())throw new K("`localStorage` is unavailable, but it is required for TonConnect. For more details, see https://github.com/ton-connect/sdk/tree/main/packages/sdk#init-connector");return at.getInstance()}function go(){try{return typeof localStorage<"u"}catch{return!1}}function xo(){return typeof process<"u"&&process.versions!=null&&process.versions.node!=null}class Pe{constructor(e,t){this.injectedWalletKey=t,this.type="injected",this.unsubscribeCallback=null,this.listenSubscriptions=!1,this.listeners=[];const o=Pe.window;if(!Pe.isWindowContainsWallet(o,t))throw new In;this.connectionStorage=new St(e),this.injectedWallet=o[t].tonconnect}static fromStorage(e){return L(this,void 0,void 0,function*(){const o=yield new St(e).getInjectedConnection();return new Pe(e,o.jsBridgeKey)})}static isWalletInjected(e){return Pe.isWindowContainsWallet(this.window,e)}static isInsideWalletBrowser(e){return Pe.isWindowContainsWallet(this.window,e)?this.window[e].tonconnect.isWalletBrowser:!1}static getCurrentlyInjectedWallets(){return this.window?co().filter(([o,s])=>fo(s)).map(([o,s])=>({name:s.tonconnect.walletInfo.name,appName:s.tonconnect.walletInfo.app_name,aboutUrl:s.tonconnect.walletInfo.about_url,imageUrl:s.tonconnect.walletInfo.image,tondns:s.tonconnect.walletInfo.tondns,jsBridgeKey:o,injected:!0,embedded:s.tonconnect.isWalletBrowser,platforms:s.tonconnect.walletInfo.platforms})):[]}static isWindowContainsWallet(e,t){return!!e&&t in e&&typeof e[t]=="object"&&"tonconnect"in e[t]}connect(e){this._connect(Br,e)}restoreConnection(){return L(this,void 0,void 0,function*(){try{me("Injected Provider restoring connection...");const e=yield this.injectedWallet.restoreConnection();me("Injected Provider restoring connection response",e),e.event==="connect"?(this.makeSubscriptions(),this.listeners.forEach(t=>t(e))):yield this.connectionStorage.removeConnection()}catch(e){yield this.connectionStorage.removeConnection(),console.error(e)}})}closeConnection(){this.listenSubscriptions&&this.injectedWallet.disconnect(),this.closeAllListeners()}disconnect(){return L(this,void 0,void 0,function*(){return new Promise(e=>{const t=()=>{this.closeAllListeners(),this.connectionStorage.removeConnection().then(e)};try{this.injectedWallet.disconnect(),t()}catch(o){me(o),this.sendRequest({method:"disconnect",params:[]},t)}})})}closeAllListeners(){var e;this.listenSubscriptions=!1,this.listeners=[],(e=this.unsubscribeCallback)===null||e===void 0||e.call(this)}listen(e){return this.listeners.push(e),()=>this.listeners=this.listeners.filter(t=>t!==e)}sendRequest(e,t){var o;return L(this,void 0,void 0,function*(){const s={};typeof t=="function"?s.onRequestSent=t:(s.onRequestSent=t?.onRequestSent,s.signal=t?.signal);const l=(yield this.connectionStorage.getNextRpcRequestId()).toString();yield this.connectionStorage.increaseNextRpcRequestId(),me("Send injected-bridge request:",Object.assign(Object.assign({},e),{id:l}));const h=this.injectedWallet.send(Object.assign(Object.assign({},e),{id:l}));return h.then(d=>me("Wallet message received:",d)),(o=s?.onRequestSent)===null||o===void 0||o.call(s),h})}_connect(e,t){return L(this,void 0,void 0,function*(){try{me(`Injected Provider connect request: protocolVersion: ${e}, message:`,t);const o=yield this.injectedWallet.connect(e,t);me("Injected Provider connect response:",o),o.event==="connect"&&(yield this.updateSession(),this.makeSubscriptions()),this.listeners.forEach(s=>s(o))}catch(o){me("Injected Provider connect error:",o);const s={event:"connect_error",payload:{code:0,message:o?.toString()}};this.listeners.forEach(l=>l(s))}})}makeSubscriptions(){this.listenSubscriptions=!0,this.unsubscribeCallback=this.injectedWallet.listen(e=>{me("Wallet message received:",e),this.listenSubscriptions&&this.listeners.forEach(t=>t(e)),e.event==="disconnect"&&this.disconnect()})}updateSession(){return this.connectionStorage.storeConnection({type:"injected",jsBridgeKey:this.injectedWalletKey,nextRpcRequestId:0})}}Pe.window=en();class vo{constructor(){this.localStorage=ho()}getItem(e){return L(this,void 0,void 0,function*(){return this.localStorage.getItem(e)})}removeItem(e){return L(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}setItem(e,t){return L(this,void 0,void 0,function*(){this.localStorage.setItem(e,t)})}}function po(r){return bo(r)&&r.injected}function yo(r){return po(r)&&r.embedded}function bo(r){return"jsBridgeKey"in r}const wo=[{app_name:"telegram-wallet",name:"Wallet",image:"https://wallet.tg/images/logo-288.png",about_url:"https://wallet.tg/",universal_url:"https://t.me/wallet?attach=wallet",bridge:[{type:"sse",url:"https://bridge.tonapi.io/bridge"}],platforms:["ios","android","macos","windows","linux"]},{app_name:"tonkeeper",name:"Tonkeeper",image:"https://tonkeeper.com/assets/tonconnect-icon.png",tondns:"tonkeeper.ton",about_url:"https://tonkeeper.com",universal_url:"https://app.tonkeeper.com/ton-connect",deepLink:"tonkeeper-tc://",bridge:[{type:"sse",url:"https://bridge.tonapi.io/bridge"},{type:"js",key:"tonkeeper"}],platforms:["ios","android","chrome","firefox","macos"]},{app_name:"mytonwallet",name:"MyTonWallet",image:"https://mytonwallet.io/icon-256.png",about_url:"https://mytonwallet.io",universal_url:"https://connect.mytonwallet.org",bridge:[{type:"js",key:"mytonwallet"},{type:"sse",url:"https://tonconnectbridge.mytonwallet.org/bridge/"}],platforms:["chrome","windows","macos","linux","ios","android","firefox"]},{app_name:"openmask",name:"OpenMask",image:"https://raw.githubusercontent.com/OpenProduct/openmask-extension/main/public/openmask-logo-288.png",about_url:"https://www.openmask.app/",bridge:[{type:"js",key:"openmask"}],platforms:["chrome"]},{app_name:"tonhub",name:"Tonhub",image:"https://tonhub.com/tonconnect_logo.png",about_url:"https://tonhub.com",universal_url:"https://tonhub.com/ton-connect",bridge:[{type:"js",key:"tonhub"},{type:"sse",url:"https://connect.tonhubapi.com/tonconnect"}],platforms:["ios","android"]},{app_name:"dewallet",name:"DeWallet",image:"https://app.delabwallet.com/logo_black.png",about_url:"https://delabwallet.com",bridge:[{type:"js",key:"dewallet"}],platforms:["chrome"]},{app_name:"xtonwallet",name:"XTONWallet",image:"https://xtonwallet.com/assets/img/icon-256-back.png",about_url:"https://xtonwallet.com",bridge:[{type:"js",key:"xtonwallet"}],platforms:["chrome","firefox"]},{app_name:"tonwallet",name:"TON Wallet",image:"https://wallet.ton.org/assets/ui/qr-logo.png",about_url:"https://chrome.google.com/webstore/detail/ton-wallet/nphplpgoakhhjchkkhmiggakijnkhfnd",bridge:[{type:"js",key:"tonwallet"}],platforms:["chrome"]}];class An{constructor(e){this.walletsListCache=null,this.walletsListCacheCreationTimestamp=null,this.walletsListSource="https://raw.githubusercontent.com/ton-blockchain/wallets-list/main/wallets-v2.json",e?.walletsListSource&&(this.walletsListSource=e.walletsListSource),e?.cacheTTLMs&&(this.cacheTTLMs=e.cacheTTLMs)}getWallets(){return L(this,void 0,void 0,function*(){return this.cacheTTLMs&&this.walletsListCacheCreationTimestamp&&Date.now()>this.walletsListCacheCreationTimestamp+this.cacheTTLMs&&(this.walletsListCache=null),this.walletsListCache||(this.walletsListCache=this.fetchWalletsList(),this.walletsListCache.then(()=>{this.walletsListCacheCreationTimestamp=Date.now()}).catch(()=>{this.walletsListCache=null,this.walletsListCacheCreationTimestamp=null})),this.walletsListCache})}getEmbeddedWallet(){return L(this,void 0,void 0,function*(){const t=(yield this.getWallets()).filter(yo);return t.length!==1?null:t[0]})}fetchWalletsList(){return L(this,void 0,void 0,function*(){let e=[];try{if(e=yield(yield fetch(this.walletsListSource)).json(),!Array.isArray(e))throw new Bn("Wrong wallets list format, wallets list must be an array.");const s=e.filter(l=>!this.isCorrectWalletConfigDTO(l));s.length&&(De(`Wallet(s) ${s.map(l=>l.name).join(", ")} config format is wrong. They were removed from the wallets list.`),e=e.filter(l=>this.isCorrectWalletConfigDTO(l)))}catch(o){De(o),e=wo}let t=[];try{t=Pe.getCurrentlyInjectedWallets()}catch(o){De(o)}return this.mergeWalletsLists(this.walletConfigDTOListToWalletConfigList(e),t)})}walletConfigDTOListToWalletConfigList(e){return e.map(t=>{const s={name:t.name,appName:t.app_name,imageUrl:t.image,aboutUrl:t.about_url,tondns:t.tondns,platforms:t.platforms};return t.bridge.forEach(l=>{if(l.type==="sse"&&(s.bridgeUrl=l.url,s.universalLink=t.universal_url,s.deepLink=t.deepLink),l.type==="js"){const h=l.key;s.jsBridgeKey=h,s.injected=Pe.isWalletInjected(h),s.embedded=Pe.isInsideWalletBrowser(h)}}),s})}mergeWalletsLists(e,t){return[...new Set(e.concat(t).map(s=>s.name)).values()].map(s=>{const l=e.find(d=>d.name===s),h=t.find(d=>d.name===s);return Object.assign(Object.assign({},l&&Object.assign({},l)),h&&Object.assign({},h))})}isCorrectWalletConfigDTO(e){if(!e||typeof e!="object")return!1;const t="name"in e,o="app_name"in e,s="image"in e,l="about_url"in e,h="platforms"in e;if(!t||!s||!l||!h||!o||!e.platforms||!Array.isArray(e.platforms)||!e.platforms.length||!("bridge"in e)||!Array.isArray(e.bridge)||!e.bridge.length)return!1;const d=e.bridge;if(d.some(A=>!A||typeof A!="object"||!("type"in A)))return!1;const S=d.find(A=>A.type==="sse");if(S&&(!("url"in S)||!S.url||!e.universal_url))return!1;const m=d.find(A=>A.type==="js");return!(m&&(!("key"in m)||!m.key))}}class Yt extends K{get info(){return"Wallet doesn't support requested feature method."}constructor(...e){super(...e),Object.setPrototypeOf(this,Yt.prototype)}}function mo(r,e){const t=r.includes("SendTransaction"),o=r.find(s=>s&&typeof s=="object"&&s.name==="SendTransaction");if(!t&&!o)throw new Yt("Wallet doesn't support SendTransaction feature.");if(o&&o.maxMessages!==void 0){if(o.maxMessages<e.requiredMessagesNumber)throw new Yt(`Wallet is not able to handle such SendTransaction request. Max support messages number is ${o.maxMessages}, but ${e.requiredMessagesNumber} is required.`);return}io("Connected wallet didn't provide information about max allowed messages in the SendTransaction request. Request may be rejected by the wallet.")}function _o(){return{type:"request-version"}}function So(r){return{type:"response-version",version:r}}function ft(r){return{ton_connect_sdk_lib:r.ton_connect_sdk_lib,ton_connect_ui_lib:r.ton_connect_ui_lib}}function ct(r,e){var t,o,s,l,h,d,S,m;const B=((t=e?.connectItems)===null||t===void 0?void 0:t.tonProof)&&"proof"in e.connectItems.tonProof?"ton_proof":"ton_addr";return{wallet_address:(s=(o=e?.account)===null||o===void 0?void 0:o.address)!==null&&s!==void 0?s:null,wallet_type:(l=e?.device.appName)!==null&&l!==void 0?l:null,wallet_version:(h=e?.device.appVersion)!==null&&h!==void 0?h:null,auth_type:B,custom_data:Object.assign({chain_id:(S=(d=e?.account)===null||d===void 0?void 0:d.chain)!==null&&S!==void 0?S:null,provider:(m=e?.provider)!==null&&m!==void 0?m:null},ft(r))}}function Eo(r){return{type:"connection-started",custom_data:ft(r)}}function Co(r,e){return Object.assign({type:"connection-completed",is_success:!0},ct(r,e))}function Ao(r,e,t){return{type:"connection-error",is_success:!1,error_message:e,error_code:t??null,custom_data:ft(r)}}function Ro(r){return{type:"connection-restoring-started",custom_data:ft(r)}}function Uo(r,e){return Object.assign({type:"connection-restoring-completed",is_success:!0},ct(r,e))}function Po(r,e){return{type:"connection-restoring-error",is_success:!1,error_message:e,custom_data:ft(r)}}function Wn(r,e){var t,o,s,l;return{valid_until:(t=String(e.validUntil))!==null&&t!==void 0?t:null,from:(l=(o=e.from)!==null&&o!==void 0?o:(s=r?.account)===null||s===void 0?void 0:s.address)!==null&&l!==void 0?l:null,messages:e.messages.map(h=>{var d,S;return{address:(d=h.address)!==null&&d!==void 0?d:null,amount:(S=h.amount)!==null&&S!==void 0?S:null}})}}function To(r,e,t){return Object.assign(Object.assign({type:"transaction-sent-for-signature"},ct(r,e)),Wn(e,t))}function Lo(r,e,t,o){return Object.assign(Object.assign({type:"transaction-signed",is_success:!0,signed_transaction:o.boc},ct(r,e)),Wn(e,t))}function jo(r,e,t,o,s){return Object.assign(Object.assign({type:"transaction-signing-failed",is_success:!1,error_message:o,error_code:s??null},ct(r,e)),Wn(e,t))}function Io(r,e,t){return Object.assign({type:"disconnection",scope:t},ct(r,e))}class Bo{constructor(){this.window=en()}dispatchEvent(e,t){var o;return L(this,void 0,void 0,function*(){const s=new CustomEvent(e,{detail:t});(o=this.window)===null||o===void 0||o.dispatchEvent(s)})}addEventListener(e,t,o){var s;return L(this,void 0,void 0,function*(){return(s=this.window)===null||s===void 0||s.addEventListener(e,t,o),()=>{var l;return(l=this.window)===null||l===void 0?void 0:l.removeEventListener(e,t)}})}}class Wo{constructor(e){var t;this.eventPrefix="ton-connect-",this.tonConnectUiVersion=null,this.eventDispatcher=(t=e?.eventDispatcher)!==null&&t!==void 0?t:new Bo,this.tonConnectSdkVersion=e.tonConnectSdkVersion,this.init().catch()}get version(){return ft({ton_connect_sdk_lib:this.tonConnectSdkVersion,ton_connect_ui_lib:this.tonConnectUiVersion})}init(){return L(this,void 0,void 0,function*(){try{yield this.setRequestVersionHandler(),this.tonConnectUiVersion=yield this.requestTonConnectUiVersion()}catch{}})}setRequestVersionHandler(){return L(this,void 0,void 0,function*(){yield this.eventDispatcher.addEventListener("ton-connect-request-version",()=>L(this,void 0,void 0,function*(){yield this.eventDispatcher.dispatchEvent("ton-connect-response-version",So(this.tonConnectSdkVersion))}))})}requestTonConnectUiVersion(){return L(this,void 0,void 0,function*(){return new Promise((e,t)=>L(this,void 0,void 0,function*(){try{yield this.eventDispatcher.addEventListener("ton-connect-ui-response-version",o=>{e(o.detail.version)},{once:!0}),yield this.eventDispatcher.dispatchEvent("ton-connect-ui-request-version",_o())}catch(o){t(o)}}))})}dispatchUserActionEvent(e){try{this.eventDispatcher.dispatchEvent(`${this.eventPrefix}${e.type}`,e).catch()}catch{}}trackConnectionStarted(...e){try{const t=Eo(this.version,...e);this.dispatchUserActionEvent(t)}catch{}}trackConnectionCompleted(...e){try{const t=Co(this.version,...e);this.dispatchUserActionEvent(t)}catch{}}trackConnectionError(...e){try{const t=Ao(this.version,...e);this.dispatchUserActionEvent(t)}catch{}}trackConnectionRestoringStarted(...e){try{const t=Ro(this.version,...e);this.dispatchUserActionEvent(t)}catch{}}trackConnectionRestoringCompleted(...e){try{const t=Uo(this.version,...e);this.dispatchUserActionEvent(t)}catch{}}trackConnectionRestoringError(...e){try{const t=Po(this.version,...e);this.dispatchUserActionEvent(t)}catch{}}trackDisconnection(...e){try{const t=Io(this.version,...e);this.dispatchUserActionEvent(t)}catch{}}trackTransactionSentForSignature(...e){try{const t=To(this.version,...e);this.dispatchUserActionEvent(t)}catch{}}trackTransactionSigned(...e){try{const t=Lo(this.version,...e);this.dispatchUserActionEvent(t)}catch{}}trackTransactionSigningFailed(...e){try{const t=jo(this.version,...e);this.dispatchUserActionEvent(t)}catch{}}}const Mo="3.0.3";class tn{constructor(e){if(this.walletsList=new An,this._wallet=null,this.provider=null,this.statusChangeSubscriptions=[],this.statusChangeErrorSubscriptions=[],this.dappSettings={manifestUrl:e?.manifestUrl||uo(),storage:e?.storage||new vo},this.walletsList=new An({walletsListSource:e?.walletsListSource,cacheTTLMs:e?.walletsListCacheTTLMs}),this.tracker=new Wo({eventDispatcher:e?.eventDispatcher,tonConnectSdkVersion:Mo}),!this.dappSettings.manifestUrl)throw new Ln("Dapp tonconnect-manifest.json must be specified if window.location.origin is undefined. See more https://github.com/ton-connect/docs/blob/main/requests-responses.md#app-manifest");this.bridgeConnectionStorage=new St(this.dappSettings.storage),e?.disableAutoPauseConnection||this.addWindowFocusAndBlurSubscriptions()}static getWallets(){return this.walletsList.getWallets()}get connected(){return this._wallet!==null}get account(){var e;return((e=this._wallet)===null||e===void 0?void 0:e.account)||null}get wallet(){return this._wallet}set wallet(e){this._wallet=e,this.statusChangeSubscriptions.forEach(t=>t(this._wallet))}getWallets(){return this.walletsList.getWallets()}onStatusChange(e,t){return this.statusChangeSubscriptions.push(e),t&&this.statusChangeErrorSubscriptions.push(t),()=>{this.statusChangeSubscriptions=this.statusChangeSubscriptions.filter(o=>o!==e),t&&(this.statusChangeErrorSubscriptions=this.statusChangeErrorSubscriptions.filter(o=>o!==t))}}connect(e,t){var o,s;const l={};if(typeof t=="object"&&"tonProof"in t&&(l.request=t),typeof t=="object"&&("openingDeadlineMS"in t||"signal"in t||"request"in t)&&(l.request=t?.request,l.openingDeadlineMS=t?.openingDeadlineMS,l.signal=t?.signal),this.connected)throw new jn;const h=Oe(l?.signal);if((o=this.abortController)===null||o===void 0||o.abort(),this.abortController=h,h.signal.aborted)throw new K("Connection was aborted");return(s=this.provider)===null||s===void 0||s.closeConnection(),this.provider=this.createProvider(e),h.signal.addEventListener("abort",()=>{var d;(d=this.provider)===null||d===void 0||d.closeConnection(),this.provider=null}),this.tracker.trackConnectionStarted(),this.provider.connect(this.createConnectRequest(l?.request),{openingDeadlineMS:l?.openingDeadlineMS,signal:h.signal})}restoreConnection(e){var t,o;return L(this,void 0,void 0,function*(){this.tracker.trackConnectionRestoringStarted();const s=Oe(e?.signal);if((t=this.abortController)===null||t===void 0||t.abort(),this.abortController=s,s.signal.aborted){this.tracker.trackConnectionRestoringError("Connection restoring was aborted");return}const[l,h]=yield Promise.all([this.bridgeConnectionStorage.storedConnectionType(),this.walletsList.getEmbeddedWallet()]);if(s.signal.aborted){this.tracker.trackConnectionRestoringError("Connection restoring was aborted");return}let d=null;try{switch(l){case"http":d=yield Et.fromStorage(this.dappSettings.storage);break;case"injected":d=yield Pe.fromStorage(this.dappSettings.storage);break;default:if(h)d=this.createProvider(h);else return}}catch{this.tracker.trackConnectionRestoringError("Provider is not restored"),yield this.bridgeConnectionStorage.removeConnection(),d?.closeConnection(),d=null;return}if(s.signal.aborted){d?.closeConnection(),this.tracker.trackConnectionRestoringError("Connection restoring was aborted");return}if(!d){De("Provider is not restored"),this.tracker.trackConnectionRestoringError("Provider is not restored");return}(o=this.provider)===null||o===void 0||o.closeConnection(),this.provider=d,d.listen(this.walletEventsListener.bind(this));const S=()=>{this.tracker.trackConnectionRestoringError("Connection restoring was aborted"),d?.closeConnection(),d=null};return s.signal.addEventListener("abort",S),yield bt(m=>L(this,void 0,void 0,function*(){yield d?.restoreConnection({openingDeadlineMS:e?.openingDeadlineMS,signal:m.signal}),s.signal.removeEventListener("abort",S),this.connected?this.tracker.trackConnectionRestoringCompleted(this.wallet):this.tracker.trackConnectionRestoringError("Connection restoring failed")}),{attempts:Number.MAX_SAFE_INTEGER,delayMs:5e3,signal:e?.signal})})}sendTransaction(e,t){return L(this,void 0,void 0,function*(){const o={};typeof t=="function"?o.onRequestSent=t:(o.onRequestSent=t?.onRequestSent,o.signal=t?.signal);const s=Oe(o?.signal);if(s.signal.aborted)throw new K("Transaction sending was aborted");this.checkConnection(),mo(this.wallet.device.features,{requiredMessagesNumber:e.messages.length}),this.tracker.trackTransactionSentForSignature(this.wallet,e);const{validUntil:l}=e,h=Ji(e,["validUntil"]),d=e.from||this.account.address,S=e.network||this.account.chain,m=yield this.provider.sendRequest(Nt.convertToRpcRequest(Object.assign(Object.assign({},h),{valid_until:l,from:d,network:S})),{onRequestSent:o.onRequestSent,signal:s.signal});if(Nt.isError(m))return this.tracker.trackTransactionSigningFailed(this.wallet,e,m.error.message,m.error.code),Nt.parseAndThrowError(m);const A=Nt.convertFromRpcResponse(m);return this.tracker.trackTransactionSigned(this.wallet,e,A),A})}disconnect(e){var t;return L(this,void 0,void 0,function*(){if(!this.connected)throw new qt;const o=Oe(e?.signal),s=this.abortController;if(this.abortController=o,o.signal.aborted)throw new K("Disconnect was aborted");this.onWalletDisconnected("dapp"),yield(t=this.provider)===null||t===void 0?void 0:t.disconnect({signal:o.signal}),s?.abort()})}pauseConnection(){var e;((e=this.provider)===null||e===void 0?void 0:e.type)==="http"&&this.provider.pause()}unPauseConnection(){var e;return((e=this.provider)===null||e===void 0?void 0:e.type)!=="http"?Promise.resolve():this.provider.unPause()}addWindowFocusAndBlurSubscriptions(){const e=lo();if(e)try{e.addEventListener("visibilitychange",()=>{e.hidden?this.pauseConnection():this.unPauseConnection().catch()})}catch(t){De("Cannot subscribe to the document.visibilitychange: ",t)}}createProvider(e){let t;return!Array.isArray(e)&&zi(e)?t=new Pe(this.dappSettings.storage,e.jsBridgeKey):t=new Et(this.dappSettings.storage,e),t.listen(this.walletEventsListener.bind(this)),t}walletEventsListener(e){switch(e.event){case"connect":this.onWalletConnected(e.payload);break;case"connect_error":this.onWalletConnectError(e.payload);break;case"disconnect":this.onWalletDisconnected("wallet")}}onWalletConnected(e){const t=e.items.find(l=>l.name==="ton_addr"),o=e.items.find(l=>l.name==="ton_proof");if(!t)throw new K("ton_addr connection item was not found");const s={device:e.device,provider:this.provider.type,account:{address:t.address,chain:t.network,walletStateInit:t.walletStateInit,publicKey:t.publicKey}};o&&(s.connectItems={tonProof:o}),this.wallet=s,this.tracker.trackConnectionCompleted(s)}onWalletConnectError(e){const t=Zi.parseError(e);if(this.statusChangeErrorSubscriptions.forEach(o=>o(t)),me(t),this.tracker.trackConnectionError(e.message,e.code),t instanceof Xt||t instanceof zt)throw De(t),t}onWalletDisconnected(e){this.tracker.trackDisconnection(this.wallet,e),this.wallet=null}checkConnection(){if(!this.connected)throw new qt}createConnectRequest(e){const t=[{name:"ton_addr"}];return e?.tonProof&&t.push({name:"ton_proof",payload:e.tonProof}),{manifestUrl:this.dappSettings.manifestUrl,items:t}}}tn.walletsList=new An;tn.isWalletInjected=r=>Pe.isWalletInjected(r);tn.isInsideWalletBrowser=r=>Pe.isInsideWalletBrowser(r);for(let r=0;r<=255;r++){let e=r.toString(16);e.length<2&&(e="0"+e)}var No=pr("<div><div>main mazafaka</div><div></div><button> create list");const wn=new tn,ko=()=>{const[r,e]=ot(),t=async()=>{const o=await wn.getWallets();e(o)};return wn.restoreConnection(),wn.onStatusChange(o=>{}),(()=>{var o=No(),s=o.firstChild,l=s.nextSibling,h=l.nextSibling;return br(l,()=>r.name),h.$$click=t,o})()};yr(["click"]);var Ko=pr("<div> pu pu pu 404:not founded");const Oo=()=>Ko(),Fo=()=>Me(Ii,{get children(){return[Me(Xn,{path:"/pinkpunk_tma",component:ko}),Me(Xn,{path:"*404",component:Oo})]}}),Do=document.getElementById("root");oi(()=>Me(Fo,{}),Do);
